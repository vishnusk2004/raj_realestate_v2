{% load static %}
{% load humanize %}
{% load price_filters %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ brand_name }} - Find Your Dream Home</title>
    <meta name="description"
          content="Professional real estate services with AI-powered insights. Find your perfect property with {{ brand_name }}.">
    <link rel="icon" type="image/png" href="{% static 'favicon.png' %}">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
            rel="stylesheet">

    <link rel="stylesheet" href="{% static 'css/django-main.css' %}">
    <style>
        /* Prevent layout shift - reserve space for images */
        img[loading="lazy"] {
            background-color: #f3f4f6;
            min-height: 200px;
        }

        /* Ensure page structure loads first */
        img {
            content-visibility: auto;
        }

        /* Image loading placeholder */
        img[loading="lazy"]::before {
            content: '';
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }


        .profile-box {
            width: 360px;
            height: 360px;
            border-radius: 20px;
        {#overflow: hidden;#}
            /* background: #f3f4f6; */
            /* box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15); */
        }

        .profile-box img {
            width: 100%;
            height: 100%;
        {#object-fit: cover;#} object-position: top;
            display: block;
        }

        @media (min-width: 640px) {
            .profile-box {
                width: 240px;
                height: 400px;
            }
        }

        @media (min-width: 768px) {
            .profile-box {
                width: 280px;
                height: 460px;
            }
        }

        @media (min-width: 1024px) {
            .profile-box {
                width: 300px;
                height: 500px;
            }
        }

        /* Base style for both */
        .profile-box {
            width: 220px;
            height: 360px;
            border-radius: 10px;
            overflow: hidden;
        }

        .profile-box img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Default for Anita */
            object-position: top;
            display: block;
        }

        /* Specific overrides ONLY for Raj */
        .raj-box {
            width: 360px !important; /* Forces the wider width you wanted */
            background: transparent; /* Optional: cleaner for removebg images */
        }

        .raj-box img {
            object-fit: contain !important; /* Shows full image without cropping */
            object-position: bottom; /* Aligns him to the bottom of the box */
        }

        /* Responsive adjustments ONLY for Raj's width */
        @media (min-width: 768px) {
            .raj-box {
                width: 400px !important;
            }
        }

        @media (min-width: 1024px) {
            .raj-box {
                width: 450px !important;
            }
        }

        /* Modal Styles */
        #imageCarousel {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            background-color: #f3f4f6 !important;
            min-height: 16rem !important;
            max-height: 24rem !important;
        }

        #modalImageSrc {
            object-fit: contain !important;
            object-position: center !important;
            max-width: 100% !important;
            max-height: 24rem !important;
            width: auto !important;
            height: auto !important;
        }
    </style>

</head>

<body>
{% include 'Raj/social_media_sidebar.html' %}
<div class="flex flex-col min-h-screen">
    {% include 'Raj/navbar.html' %}

    <main class="flex-1">
        <div class="min-h-screen">
            <section class="relative h-screen flex items-center justify-center overflow-hidden">
                <video class="absolute inset-0 w-full h-full object-cover" autoplay muted loop playsinline
                       poster="{% static 'Images/hero-poster.jpg' %}">
                    <source src="{% static 'videos/hero_video_v2.mp4' %}" type="video/mp4">
                </video>

                <div class="absolute inset-0 bg-gradient-hero opacity-60"></div>

                <div class="relative z-10 text-center max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="animate-fade-in-up">
                        <p class="text-sm text-primary-foreground mb-4"
                           style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">Serving all of Houston (HTX) and Austin
                            (ATX)</p>

                        <h1 class="font-display text-balance leading-[1.1] text-primary-foreground mb-8"
                            style="text-shadow: 2px 2px 8px rgba(0,0,0,0.8);">Find Your Dream Home With Us</h1>

                        <p class="text-xl md:text-2xl text-primary-foreground mx-auto leading-relaxed whitespace-normal md:whitespace-nowrap"
                           style="text-shadow: 2px 2px 6px rgba(0,0,0,0.8); margin-bottom: 5rem;">
                            Discover the best properties and insights with our expert real estate solutions.
                        </p>

                        <div class="flex justify-center gap-12 mb-6 max-w-[600px] mx-auto">
                <span class="text-lg text-white text-center underline drop-shadow-xl"
                      style="text-shadow:2px 2px 4px rgba(0,0,0,0.8); color: white;">Buy</span>
                            <span class="text-lg text-white text-center underline drop-shadow-xl"
                                  style="text-shadow:2px 2px 4px rgba(0,0,0,0.8); color: white;">Sell</span>
                            <span class="text-lg text-white text-center underline drop-shadow-xl"
                                  style="text-shadow:2px 2px 4px rgba(0,0,0,0.8); color: white;">Lease</span>
                        </div>

                        <button type="button" onclick="openHeroContactModal()"
                                class="text-2xl md:text-3xl mb-8 font-bold px-8 py-4 rounded-lg border-2 backdrop-blur-sm transition-all duration-300 block text-center mx-auto max-w-[600px] hover:scale-[1.02] cursor-pointer w-full"
                                style="background-color: #D4AF37 !important;
          border-color: #E5C35D !important;
          color: #000000 !important;
          text-shadow: none !important;
          box-shadow: 0 0 20px rgba(212, 175, 55, 0.5) !important;"
                                onmouseover="this.style.backgroundColor='#B5952F'; this.style.boxShadow='0 0 30px rgba(212, 175, 55, 0.7)';"
                                onmouseout="this.style.backgroundColor='#D4AF37'; this.style.boxShadow='0 0 20px rgba(212, 175, 55, 0.5)';">
                            Contact Raj
                        </button>

                        <div class="flex flex-wrap justify-center gap-8 md:gap-12 mb-10 max-w-[600px] mx-auto">
                <span class="font-semibold text-lg text-white text-center underline drop-shadow-xl"
                      style="text-shadow:2px 2px 3px rgba(0,0,0,0.8); color: white;">Residential</span>
                            <span class="font-semibold text-lg text-white text-center underline drop-shadow-xl"
                                  style="text-shadow:2px 2px 3px rgba(0,0,0,0.8); color: white;">Commercial</span>
                            <span class="font-semibold text-lg text-white text-center underline drop-shadow-xl"
                                  style="text-shadow:2px 2px 3px rgba(0,0,0,0.8); color: white;">Land</span>
                            <span class="font-semibold text-lg text-white text-center underline drop-shadow-xl"
                                  style="text-shadow:2px 2px 3px rgba(0,0,0,0.8); color: white;">Industrial</span>
                        </div>
                    </div>
                </div>
            </section>


            <section class="py-24 bg-gradient-surface">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="max-w-4xl mx-auto text-center animate-fade-in-up">
                        <div class="inline-flex items-center rounded-full border text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover:bg-primary/80 mb-6 bg-accent/10 text-accent-foreground border-accent/20 px-4 py-2">
                            About Raj
                        </div>

                        <h2 class="font-display text-balance mb-8">Your Trusted Real Estate Partner</h2>

                        <div class="relative flex flex-col sm:flex-row gap-6 sm:gap-8 justify-center items-center mb-12">
                            <div class="flex flex-col items-center">
                                <div class="profile-box raj-box">
                                    <img src="{% static 'Images/image-removebg-preview.png' %}" alt="Raj"/>
                                </div>
                                <p class="mt-4 text-lg font-semibold">Raj</p>
                            </div>

                            <div class="flex flex-col items-center">
                                <div class="profile-box">
                                    <img src="{% static 'Images/Anita.png' %}" alt="Anita"/>
                                </div>
                                <p class="mt-4 text-lg font-semibold">Anita</p>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-8 mb-10 text-left">
                            <div class="space-y-4">
                                <p class="text-muted-foreground text-lg leading-relaxed text-balance">
                                    With over 30 years of combined professional experience as a technologist and
                                    a seasoned realtor, I bring a unique blend of expertise, dedication, and
                                    results to every client he serves.
                                </p>
                                <p class="text-muted-foreground text-lg leading-relaxed text-balance">
                                    I'm known for strong negotiation skills and a sharp eye for finding the right
                                    properties, I have built a reputation for delivering best-in-class service
                                    in buying, selling, and leasing real estate across Texas.
                                </p>
                            </div>
                            <div class="space-y-4">
                                <p class="text-muted-foreground text-lg leading-relaxed text-balance">
                                    What truly sets me apart is the philosophy of quality over quantity. I take
                                    the time to understand each client's needs and go the extra mile to ensure
                                    they feel supported every step of the way.
                                </p>
                                <p class="text-muted-foreground text-lg leading-relaxed text-balance">
                                    Whether you're looking for residential, commercial, or land opportunities, I
                                    with my expert partners am committed to making your real estate experience
                                    seamless and successful.
                                </p>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4 text-muted-foreground text-md border-t pt-8">
                            <div class="text-right pr-4 border-r">
                                <p class="mb-1">Licensed Texas Real Estate Agent</p>
                                <p>Member, Houston Association of Realtors</p>
                            </div>
                            <div class="text-left pl-4">
                                <p class="mb-1">Member, Texas Association of Realtors</p>
                                <p>Member, National Association of Realtors</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">Intelligent Property Matching
                                    </h4>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">Social Media Marketing</h4>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">Video/Drone Marketing</h4>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">MLS Listing Services</h4>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">Market Insight</h4>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">Expert Negotiation</h4>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">Personalized Services</h4>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-circle-check-big w-5 h-5 text-accent flex-shrink-0">
                                    <path d="M21.801 10A10 10 0 1 1 17 3.335"></path>
                                    <path d="m9 11 3 3L22 4"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-foreground text-xl">Creative Investing</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="py-16 bg-background">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl md:text-4xl font-bold text-foreground mb-4">Recently Sold</h2>
                    </div>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6" id="just-sold-grid">
                        {% for property in just_sold_properties %}
                            <div class="property-card rounded-lg border bg-card text-card-foreground shadow-sm group overflow-hidden shadow-soft hover:shadow-medium transition-all duration-300 animate-fade-in {% if forloop.counter > 12 %}hidden{% endif %}">
                                <div class="relative overflow-hidden">
                                    {% if property.get_main_image_url %}
                                        <img src="{{ property.get_main_image_url }}" alt="{{ property.title }}"
                                             class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                                             loading="lazy" decoding="async">
                                    {% else %}
                                        <div class="w-full h-48 bg-muted flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                 stroke-linecap="round" stroke-linejoin="round"
                                                 class="lucide lucide-home h-12 w-12 text-muted-foreground">
                                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                                <polyline points="9,22 9,12 15,12 15,22"></polyline>
                                            </svg>
                                        </div>
                                    {% endif %}
                                    <div class="absolute top-4 left-4 flex gap-2 flex-wrap">
                                        <div
                                                class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-accent text-accent-foreground">
                                            {{ property.get_property_status_display }}
                                        </div>
                                    </div>
                                </div>
                                <div class="p-6 space-y-4">
                                    <div>
                                        <h3 class="text-lg font-semibold text-foreground mb-2 line-clamp-1">{{ property.title }}</h3>
                                        <div class="flex items-center text-muted-foreground mb-3">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                 stroke-linecap="round" stroke-linejoin="round"
                                                 class="lucide lucide-map-pin h-4 w-4 mr-1">
                                                <path
                                                        d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0">
                                                </path>
                                                <circle cx="12" cy="10" r="3"></circle>
                                            </svg>
                                            <span class="text-sm">{{ property.location }}</span>
                                        </div>
                                    </div>
                                    {% if property.listing_agent_name %}
                                        <div class="flex items-center gap-2 mt-2">
                                            {% if property.get_listing_agent_image_url %}
                                                <img src="{{ property.get_listing_agent_image_url }}"
                                                     alt="{{ property.listing_agent_name }}"
                                                     class="w-8 h-8 rounded-full object-cover border border-gray-200">
                                            {% endif %}
                                            <p class="text-xs text-muted-foreground">
                                                Listing Agent:
                                                {% if property.listing_agent_link %}
                                                    <a href="{{ property.listing_agent_link }}" target="_blank"
                                                       rel="noopener noreferrer"
                                                       class="text-primary hover:underline font-medium">{{ property.listing_agent_name }}</a>
                                                {% else %}
                                                    <span class="font-medium">{{ property.listing_agent_name }}</span>
                                                {% endif %}
                                            </p>
                                        </div>
                                    {% endif %}
                                    <div class="flex items-center justify-between text-sm text-muted-foreground">
                                        <div class="flex items-center space-x-4">
                                            {% if property.bedrooms %}
                                                <div class="flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="lucide lucide-bed h-4 w-4 mr-1">
                                                        <path d="M2 4v16"></path>
                                                        <path d="M2 8h18a2 2 0 0 1 2 2v10"></path>
                                                        <path d="M2 17h20"></path>
                                                        <path d="M6 8v9"></path>
                                                    </svg>
                                                    <span>{{ property.bedrooms }}</span>
                                                </div>
                                            {% endif %}
                                            {% if property.bathrooms %}
                                                <div class="flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="lucide lucide-bath h-4 w-4 mr-1">
                                                        <path d="M10 4 8 6"></path>
                                                        <path d="M17 19v2"></path>
                                                        <path d="M2 12h20"></path>
                                                        <path d="M7 19v2"></path>
                                                        <path
                                                                d="M9 5 7.621 3.621A2.121 2.121 0 0 0 4 5v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5">
                                                        </path>
                                                    </svg>
                                                    <span>{{ property.bathrooms }}</span>
                                                </div>
                                            {% endif %}
                                            {% if property.area_sqft %}
                                                <div class="flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="lucide lucide-square h-4 w-4 mr-1">
                                                        <rect width="18" height="18" x="3" y="3" rx="2"></rect>
                                                    </svg>
                                                    <span>{{ property.area_sqft|floatformat:0 }}</span>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-end pt-4 border-t">
                                        <button type="button"
                                                class="view-details inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border bg-gray-100 h-10 px-3 py-2 border-primary text-primary hover:bg-primary hover:text-primary-foreground text-xs"
                                                onclick="fetchAndOpenModal(this)"
                                                data-id="{{ property.id }}"
                                                data-title="{{ property.title|escape }}"
                                                data-location="{{ property.location|escape }}"
                                                data-price="{{ property.price }}"
                                                data-type="{{ property.property_type }}"
                                                data-bedrooms="{{ property.bedrooms|default_if_none:'' }}"
                                                data-bathrooms="{{ property.bathrooms|default_if_none:'' }}"
                                                data-area="{{ property.area_sqft|default_if_none:'' }}"
                                                data-status="{{ property.property_status }}"
                                                data-agent-name="{{ property.listing_agent_name|default:''|escape }}"
                                                data-agent-link="{{ property.listing_agent_link|default:'' }}"
                                                data-agent-image="{{ property.get_listing_agent_image_url|default:'' }}"
                                                data-contact-email="{{ property.contact_email }}"
                                                data-contact-phone="{{ property.contact_phone }}">
                                            View Details
                                        </button>
                                    </div>
                                </div>
                            </div>
                        {% empty %}
                            <div class="col-span-full text-center py-12">
                                <div class="text-muted-foreground">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="lucide lucide-home h-12 w-12 mx-auto mb-4">
                                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                        <polyline points="9,22 9,12 15,12 15,22"></polyline>
                                    </svg>
                                    <p class="text-lg font-medium">No properties sold yet</p>
                                    <p class="text-sm">Check back soon for new listings!</p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    {% if just_sold_properties|length > 12 %}
                        <div class="text-center mt-12">
                            <button onclick="toggleShowMore('just-sold')" id="just-sold-toggle"
                                    class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-base font-semibold ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 px-8 py-3 shadow-md hover:shadow-lg">
                                Show More
                            </button>
                        </div>
                    {% endif %}
                </div>
            </section>

            <section class="py-16 bg-surface-gradient">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl md:text-4xl font-bold text-foreground mb-4">Recently Leased</h2>
                    </div>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6" id="just-leased-grid">
                        {% for property in just_leased_properties %}
                            <div class="property-card rounded-lg border bg-card text-card-foreground shadow-sm group overflow-hidden shadow-soft hover:shadow-medium transition-all duration-300 animate-fade-in {% if forloop.counter > 12 %}hidden{% endif %}">
                                <div class="relative overflow-hidden">
                                    {% if property.get_main_image_url %}
                                        <img src="{{ property.get_main_image_url }}" alt="{{ property.title }}"
                                             class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                                             loading="lazy" decoding="async">
                                    {% else %}
                                        <div class="w-full h-48 bg-muted flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                 stroke-linecap="round" stroke-linejoin="round"
                                                 class="lucide lucide-home h-12 w-12 text-muted-foreground">
                                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                                <polyline points="9,22 9,12 15,12 15,22"></polyline>
                                            </svg>
                                        </div>
                                    {% endif %}
                                    <div class="absolute top-4 left-4 flex gap-2 flex-wrap">
                                        <div
                                                class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-accent text-accent-foreground">
                                            {{ property.get_property_status_display }}
                                        </div>
                                    </div>
                                </div>
                                <div class="p-6 space-y-4">
                                    <div>
                                        <h3 class="text-lg font-semibold text-foreground mb-2 line-clamp-1">{{ property.title }}</h3>
                                        <div class="flex items-center text-muted-foreground mb-3">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                 stroke-linecap="round" stroke-linejoin="round"
                                                 class="lucide lucide-map-pin h-4 w-4 mr-1">
                                                <path
                                                        d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0">
                                                </path>
                                                <circle cx="12" cy="10" r="3"></circle>
                                            </svg>
                                            <span class="text-sm">{{ property.location }}</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between text-sm text-muted-foreground">
                                        <div class="flex items-center space-x-4">
                                            {% if property.bedrooms %}
                                                <div class="flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="lucide lucide-bed h-4 w-4 mr-1">
                                                        <path d="M2 4v16"></path>
                                                        <path d="M2 8h18a2 2 0 0 1 2 2v10"></path>
                                                        <path d="M2 17h20"></path>
                                                        <path d="M6 8v9"></path>
                                                    </svg>
                                                    <span>{{ property.bedrooms }}</span>
                                                </div>
                                            {% endif %}
                                            {% if property.bathrooms %}
                                                <div class="flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="lucide lucide-bath h-4 w-4 mr-1">
                                                        <path d="M10 4 8 6"></path>
                                                        <path d="M17 19v2"></path>
                                                        <path d="M2 12h20"></path>
                                                        <path d="M7 19v2"></path>
                                                        <path
                                                                d="M9 5 7.621 3.621A2.121 2.121 0 0 0 4 5v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5">
                                                        </path>
                                                    </svg>
                                                    <span>{{ property.bathrooms }}</span>
                                                </div>
                                            {% endif %}
                                            {% if property.area_sqft %}
                                                <div class="flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="lucide lucide-square h-4 w-4 mr-1">
                                                        <rect width="18" height="18" x="3" y="3" rx="2"></rect>
                                                    </svg>
                                                    <span>{{ property.area_sqft|floatformat:0 }}</span>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-end pt-4 border-t">
                                        <button type="button"
                                                class="view-details inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border bg-background h-10 px-3 py-2 border-primary text-primary hover:bg-primary hover:text-primary-foreground text-xs"
                                                onclick="fetchAndOpenModal(this)"
                                                data-id="{{ property.id }}"
                                                data-title="{{ property.title|escape }}"
                                                data-location="{{ property.location|escape }}"
                                                data-price="{{ property.price }}"
                                                data-type="{{ property.property_type }}"
                                                data-bedrooms="{{ property.bedrooms|default_if_none:'' }}"
                                                data-bathrooms="{{ property.bathrooms|default_if_none:'' }}"
                                                data-area="{{ property.area_sqft|default_if_none:'' }}"
                                                data-status="{{ property.property_status }}"
                                                data-agent-name="{{ property.listing_agent_name|default:''|escape }}"
                                                data-agent-link="{{ property.listing_agent_link|default:'' }}"
                                                data-agent-image="{{ property.get_listing_agent_image_url|default:'' }}"
                                                data-contact-email="{{ property.contact_email }}"
                                                data-contact-phone="{{ property.contact_phone }}">
                                            View Details
                                        </button>
                                    </div>
                                </div>
                            </div>
                        {% empty %}
                            <div class="col-span-full text-center py-12">
                                <div class="text-muted-foreground">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="lucide lucide-home h-12 w-12 mx-auto mb-4">
                                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                        <polyline points="9,22 9,12 15,12 15,22"></polyline>
                                    </svg>
                                    <p class="text-lg font-medium">No properties leased yet</p>
                                    <p class="text-sm">Check back soon for new listings!</p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    {% if just_leased_properties|length > 12 %}
                        <div class="text-center mt-12">
                            <button onclick="toggleShowMore('just-leased')" id="just-leased-toggle"
                                    class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-base font-semibold ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 px-8 py-3 shadow-md hover:shadow-lg">
                                Show More
                            </button>
                        </div>
                    {% endif %}
                </div>
            </section>

            <section class="py-20 bg-gradient-surface">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-16">
                        <div
                                class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover:bg-primary/80 mb-4 bg-accent/10 text-accent-foreground border-accent/20">
                            Featured Communities
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {% for community in featured_communities %}
                            <a href="{% url 'community_detail' community.slug %}"
                               class="group flex flex-col bg-white rounded-2xl overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-500 border border-gray-100 hover:border-primary/30 transform hover:-translate-y-1">
                                <div class="relative bg-gradient-to-br from-primary/10 to-accent/10 overflow-hidden flex-shrink-0"
                                     style="height: 224px; width: 100%;">
                                    {% if community.get_image_url %}
                                        <img src="{{ community.get_image_url }}" alt="{{ community.name }}"
                                             class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700 ease-out"
                                             style="object-fit: cover; object-position: center; width: 100%; height: 100%; display: block;"
                                             loading="lazy" decoding="async">
                                    {% else %}
                                        <div class="w-full h-full bg-gradient-to-br from-primary/20 via-accent/20 to-accent/10 flex items-center justify-center"
                                             style="width: 100%; height: 100%;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="72" height="72"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="1.5"
                                                 stroke-linecap="round" stroke-linejoin="round"
                                                 class="lucide lucide-map-pin text-primary/40">
                                                <path
                                                        d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0">
                                                </path>
                                                <circle cx="12" cy="10" r="3"></circle>
                                            </svg>
                                        </div>
                                    {% endif %}

                                </div>

                                <div class="p-6 bg-white flex flex-col justify-start">
                                    <h3
                                            class="text-2xl font-bold text-foreground mb-1 group-hover:text-primary transition-colors duration-300 line-clamp-1">
                                        {{ community.name }}</h3>

                                </div>
                            </a>
                        {% empty %}
                            <div class="col-span-full text-center py-20">
                                <div
                                        class="inline-flex items-center justify-center w-24 h-24 rounded-full bg-muted/50 mb-6">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                         stroke-linejoin="round" class="lucide lucide-map-pin text-muted-foreground">
                                        <path
                                                d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0">
                                        </path>
                                        <circle cx="12" cy="10" r="3"></circle>
                                    </svg>
                                </div>
                                <p class="text-xl font-semibold text-foreground mb-2">No featured communities available
                                    yet</p>
                                <p class="text-sm text-muted-foreground">Add communities in the admin panel to see them
                                    here</p>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </section>

            {#            <div class="py-12 mb-16"></div>#}

            <section class="py-12 bg-white text-gray-800">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                        <div class="text-center animate-fade-in group">
                            <div
                                    class="bg-gray-50 p-8 rounded-2xl mb-6 shadow-lg border border-gray-200 group-hover:bg-gray-100 transition-all duration-300">
                                <div class="flex justify-center mb-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                         viewBox="0 0 24 24" fill="none" stroke="#eab308" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="lucide lucide-star w-8 h-8" style="fill: #eab308; color: #eab308;">
                                        <path
                                                d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                        </path>
                                    </svg>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                         viewBox="0 0 24 24" fill="none" stroke="#eab308" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="lucide lucide-star w-8 h-8" style="fill: #eab308; color: #eab308;">
                                        <path
                                                d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                        </path>
                                    </svg>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                         viewBox="0 0 24 24" fill="none" stroke="#eab308" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="lucide lucide-star w-8 h-8" style="fill: #eab308; color: #eab308;">
                                        <path
                                                d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                        </path>
                                    </svg>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                         viewBox="0 0 24 24" fill="none" stroke="#eab308" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="lucide lucide-star w-8 h-8" style="fill: #eab308; color: #eab308;">
                                        <path
                                                d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                        </path>
                                    </svg>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                         viewBox="0 0 24 24" fill="none" stroke="#eab308" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="lucide lucide-star w-8 h-8" style="fill: #eab308; color: #eab308;">
                                        <path
                                                d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                        </path>
                                    </svg>
                                </div>
                                <div class="text-lg font-semibold text-gray-800">Customer Satisfaction</div>
                            </div>
                        </div>
                        <div class="text-center animate-fade-in group">
                            <div
                                    class="bg-gray-50 p-8 rounded-2xl mb-6 shadow-lg border border-gray-200 group-hover:bg-gray-100 transition-all duration-300">
                                <div class="flex justify-center mb-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                                         viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="9" cy="7" r="4"></circle>
                                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                    </svg>
                                </div>
                                <div class="text-lg font-semibold text-gray-800">Highly Experienced Team</div>
                            </div>
                        </div>
                        <div class="text-center animate-fade-in group">
                            <div
                                    class="bg-gray-50 p-8 rounded-2xl mb-6 shadow-lg border border-gray-200 group-hover:bg-gray-100 transition-all duration-300">
                                <div class="text-4xl font-bold text-green-600 mb-2">5000+</div>
                                <div class="text-lg font-semibold text-gray-800">Social Media Engagements</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="py-10 bg-surface-gradient">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-12">
                        <div
                                class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover:bg-primary/80 mb-4 bg-accent/10 text-accent-foreground border-accent/20">
                            Client Testimonials
                        </div>
                    </div>
                    <div class="grid md:grid-cols-3 gap-8">
                        <div
                                class="rounded-lg bg-card text-card-foreground shadow-sm p-6 shadow-soft hover:shadow-medium transition-all duration-300 animate-fade-in border-0">
                            <div class="flex items-center mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                 fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                 stroke-linejoin="round" class="lucide lucide-quote w-8 h-8 text-accent/20 mb-4">
                                <path
                                        d="M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z">
                                </path>
                                <path
                                        d="M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z">
                                </path>
                            </svg>
                            <p class="text-muted-foreground mb-4 leading-relaxed">"Raj made finding my dream home
                                effortless. His expert recommendations were spot on!"</p>
                            <div>
                                <p class="font-semibold text-foreground">Sunflower Dental</p>
                                <p class="text-sm text-muted-foreground">Home Buyer</p>
                            </div>
                        </div>
                        <div
                                class="rounded-lg bg-card text-card-foreground shadow-sm p-6 shadow-soft hover:shadow-medium transition-all duration-300 animate-fade-in border-0">
                            <div class="flex items-center mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                 fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                 stroke-linejoin="round" class="lucide lucide-quote w-8 h-8 text-accent/20 mb-4">
                                <path
                                        d="M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z">
                                </path>
                                <path
                                        d="M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z">
                                </path>
                            </svg>
                            <p class="text-muted-foreground mb-4 leading-relaxed">"Outstanding service and market
                                insights. Raj helped me make informed investment decisions."</p>
                            <div>
                                <p class="font-semibold text-foreground">Abhi</p>
                                <p class="text-sm text-muted-foreground">Property Investor</p>
                            </div>
                        </div>
                        <div
                                class="rounded-lg bg-card text-card-foreground shadow-sm p-6 shadow-soft hover:shadow-medium transition-all duration-300 animate-fade-in border-0">
                            <div class="flex items-center mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round"
                                     class="lucide lucide-star w-4 h-4 text-accent fill-current">
                                    <path
                                            d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z">
                                    </path>
                                </svg>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                 fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                 stroke-linejoin="round" class="lucide lucide-quote w-8 h-8 text-accent/20 mb-4">
                                <path
                                        d="M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z">
                                </path>
                                <path
                                        d="M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z">
                                </path>
                            </svg>
                            <p class="text-muted-foreground mb-4 leading-relaxed">"Raj guided me through every step
                                of selling my home. Couldn't be happier with the results!"</p>
                            <div>
                                <p class="font-semibold text-foreground">Pavan</p>
                                <p class="text-sm text-muted-foreground">First-time Seller</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="py-16 bg-background border-b">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

                    <div class="flex justify-center mb-12">
                        <div class="inline-flex items-center rounded-full border px-3 py-1 text-xs font-semibold bg-primary/10 text-primary border-primary/20">
                            Our Strategic Partners
                        </div>
                    </div>

                    <div class="flex flex-col md:flex-row items-center justify-center gap-12 md:gap-24">

                        <div>
                            <h2 class="text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-tight text-foreground whitespace-nowrap">
                                Trusted <span class="text-primary">Partner</span>
                            </h2>
                        </div>

                        <a href="https://kwsw.com/" target="_blank"
                           class="group flex flex-col items-center transition-all hover:-translate-y-1">

                            <div class="w-80 h-48 bg-white rounded-xl shadow-lg border border-gray-100 flex items-center justify-center p-6 mb-4 transition-shadow group-hover:shadow-xl">
                                <img
                                        src="{% static 'Images/partners/keller_williams_southwest_logo.png' %}"
                                        alt="Keller Williams Southwest"
                                        class="max-h-full max-w-full object-contain"
                                >
                            </div>

                            <h3 class="text-2xl font-bold text-foreground group-hover:text-primary transition-colors">
                                Keller Williams Southwest
                            </h3>
                            <p class="text-muted-foreground text-base mt-1">
                                Premier Real Estate Services
                            </p>
                        </a>

                    </div>
                </div>
            </section>

            {% include 'Raj/footer.html' %}

            <div id="propertyModal"
                 class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                <div role="dialog" aria-describedby="modal-description" aria-labelledby="modal-title" data-state="open"
                     class="fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg max-w-4xl max-h-[90vh] overflow-y-auto"
                     tabindex="-1" style="pointer-events: auto;">
                    <div class="flex flex-col space-y-1.5 text-center sm:text-left">
                        <h2 id="modal-title" class="tracking-tight text-2xl font-bold">Property Details</h2>
                    </div>
                    <div class="space-y-6">
                        <div id="modalMedia" class="relative">
                            <div id="mediaCarousel"
                                 class="relative overflow-hidden rounded-lg flex items-center justify-center bg-gray-100"
                                 style="min-height: 16rem; max-height: 24rem; width: 100%; display: flex; align-items: center; justify-content: center;">
                                <img id="modalImageSrc" src="" alt="Property Image"
                                     class="w-full max-h-[24rem] object-contain transition-opacity duration-300 hidden"
                                     loading="lazy" decoding="async">
                                <video id="modalVideoSrc" controls controlsList="nodownload noplaybackrate"
                                       disablePictureInPicture
                                       oncontextmenu="return false;" onselectstart="return false;"
                                       ondragstart="return false;"
                                       preload="none"
                                       class="w-full h-full max-h-[24rem] object-contain transition-opacity duration-300 hidden"
                                       style="aspect-ratio: auto; user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                            <div id="imageNavigation" class="hidden">
                                <button id="prevImage"
                                        class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-black text-white p-4 rounded-full hover:bg-gray-800 transition-all shadow-2xl border-2 border-white">
                                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                         stroke-width="3">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path>
                                    </svg>
                                </button>
                                <button id="nextImage"
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-black text-white p-4 rounded-full hover:bg-gray-800 transition-all shadow-2xl border-2 border-white">
                                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                         stroke-width="3">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </button>
                                <div id="imageDots"
                                     class="absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-2">
                                </div>
                            </div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-xl font-semibold mb-4">Property Details</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Price:</span>
                                        <span id="modalPrice" class="font-semibold text-primary">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Location:</span>
                                        <span id="modalLocation">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Status:</span>
                                        <span id="modalStatus">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Bedrooms:</span>
                                        <span id="modalBedrooms">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Bathrooms:</span>
                                        <span id="modalBathrooms">-</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Square Feet:</span>
                                        <span id="modalArea">-</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-xl font-semibold mb-4">Features</h3>
                                <div id="modalFeatures" class="flex flex-wrap gap-2">
                                    <span class="bg-secondary text-secondary-foreground px-3 py-1 rounded-full text-sm">Modern Kitchen</span>
                                    <span class="bg-secondary text-secondary-foreground px-3 py-1 rounded-full text-sm">Hardwood Floors</span>
                                    <span class="bg-secondary text-secondary-foreground px-3 py-1 rounded-full text-sm">Central AC</span>
                                </div>
                            </div>
                        </div>
                        <div id="modalListingAgent" class="hidden border-t pt-4">
                            <h3 class="text-xl font-semibold mb-3">Listing Agent</h3>
                            <div class="flex items-center gap-4">
                                <img id="modalListingAgentImage" src="" alt="Listing Agent"
                                     class="w-20 h-20 rounded-lg object-cover hidden border border-gray-200 shadow-sm">
                                <div>
                                    <p class="text-base font-medium text-foreground mb-1">
                                        <span id="modalListingAgentNameText" class="text-muted-foreground">Listing Agent: </span>
                                        <span id="modalListingAgentName" class="font-semibold"></span>
                                        <a id="modalListingAgentLink" href="" target="_blank" rel="noopener noreferrer"
                                           class="hidden ml-2 text-primary hover:underline text-sm font-medium">Visit
                                            Profile </a>
                                    </p>
                                    <p class="text-sm text-muted-foreground">Courtesy to listing agent</p>
                                </div>
                            </div>
                        </div>
                        <div id="modalDescription" class="hidden">
                            <h3 class="text-xl font-semibold mb-4">Description</h3>
                            <p id="modalDescriptionText" class="text-muted-foreground leading-relaxed">-</p>
                        </div>
                        <div class="border-t pt-4">
                            <h3 class="text-xl font-semibold mb-4">Interested in this property?</h3>
                            <button type="button" id="modalContactBtn" onclick="openPropertyInquiryForm()"
                                    class="w-full inline-flex items-center justify-center gap-2 rounded-md text-base font-semibold ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-12 px-4 py-2 shadow-md">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round" class="lucide lucide-mail">
                                    <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                                    <path d="m22 7-10 5L2 7"></path>
                                </svg>
                                Contact Raj for Details
                            </button>
                            <p class="text-sm text-muted-foreground mt-3 text-center">Fill out the form to get expert
                                advice on this property</p>
                        </div>
                    </div>
                    <button type="button" onclick="closePropertyModal()"
                            class="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                             class="lucide lucide-x h-4 w-4">
                            <path d="M18 6 6 18"></path>
                            <path d="m6 6 12 12"></path>
                        </svg>
                        <span class="sr-only">Close</span>
                    </button>
                </div>
            </div>

            <script src="{% static 'js/django-main-fixed.js' %}"></script>

            <script>
                // Show More functionality for Just Sold and Just Leased sections
                function toggleShowMore(section) {
                    const grid = document.getElementById(section === 'just-sold' ? 'just-sold-grid' : 'just-leased-grid');
                    const toggleBtn = document.getElementById(section === 'just-sold' ? 'just-sold-toggle' : 'just-leased-toggle');
                    const allCards = Array.from(grid.querySelectorAll('.property-card'));

                    if (!allCards.length || !toggleBtn) return;

                    // Check if currently showing more (any card beyond index 11 is visible)
                    let isExpanded = false;
                    for (let i = 12; i < allCards.length; i++) {
                        if (!allCards[i].classList.contains('hidden')) {
                            isExpanded = true;
                            break;
                        }
                    }

                    // Toggle visibility
                    allCards.forEach((card, index) => {
                        if (index >= 12) {
                            if (isExpanded) {
                                // Hide cards
                                card.classList.add('hidden');
                            } else {
                                // Show cards
                                card.classList.remove('hidden');
                                card.style.animation = 'fadeIn 0.5s ease-in';
                            }
                        }
                    });

                    // Update button text
                    toggleBtn.textContent = isExpanded ? 'Show More' : 'Show Less';
                }

                function toggleFavorite(propertyId) {
                    // Get the favorite button for this property
                    const favoriteBtn = document.querySelector(`[data-property-id="${propertyId}"]`);
                    const heartIcon = favoriteBtn.querySelector('svg path');

                    // Toggle the favorite state
                    const isFavorited = favoriteBtn.classList.contains('favorited');

                    if (isFavorited) {
                        // Remove from favorites
                        favoriteBtn.classList.remove('favorited');
                        heartIcon.style.fill = 'none';
                        heartIcon.style.stroke = 'currentColor';
                        favoriteBtn.style.color = 'hsl(var(--primary))';
                    } else {
                        // Add to favorites
                        favoriteBtn.classList.add('favorited');
                        heartIcon.style.fill = 'currentColor';
                        heartIcon.style.stroke = 'currentColor';
                        favoriteBtn.style.color = 'hsl(var(--destructive))';
                    }

                    // Store in localStorage for persistence
                    const favorites = JSON.parse(localStorage.getItem('favoriteProperties') || '[]');
                    if (isFavorited) {
                        const index = favorites.indexOf(propertyId);
                        if (index > -1) {
                            favorites.splice(index, 1);
                        }
                    } else {
                        if (!favorites.includes(propertyId)) {
                            favorites.push(propertyId);
                        }
                    }
                    localStorage.setItem('favoriteProperties', JSON.stringify(favorites));

                    // Show feedback
                    const message = isFavorited ? 'Removed from favorites' : 'Added to favorites';
                    showNotification(message);
                }

                function showNotification(message) {
                    // Create a simple notification
                    const notification = document.createElement('div');
                    notification.textContent = message;
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: hsl(var(--primary));
                        color: hsl(var(--primary-foreground));
                        padding: 12px 20px;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                        z-index: 1000;
                        font-size: 14px;
                        font-weight: 500;
                        opacity: 0;
                        transform: translateX(100%);
                        transition: all 0.3s ease;
                    `;

                    document.body.appendChild(notification);

                    // Animate in
                    setTimeout(() => {
                        notification.style.opacity = '1';
                        notification.style.transform = 'translateX(0)';
                    }, 10);

                    // Remove after 3 seconds
                    setTimeout(() => {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateX(100%)';
                        setTimeout(() => {
                            document.body.removeChild(notification);
                        }, 300);
                    }, 3000);
                }

                // Load favorite states on page load
                document.addEventListener('DOMContentLoaded', function () {
                    const favorites = JSON.parse(localStorage.getItem('favoriteProperties') || '[]');
                    favorites.forEach(propertyId => {
                        const favoriteBtn = document.querySelector(`[data-property-id="${propertyId}"]`);
                        if (favoriteBtn) {
                            favoriteBtn.classList.add('favorited');
                            const heartIcon = favoriteBtn.querySelector('svg path');
                            heartIcon.style.fill = 'currentColor';
                            heartIcon.style.stroke = 'currentColor';
                            favoriteBtn.style.color = 'hsl(var(--destructive))';
                        }
                    });
                });
            </script>

            <script>
                let currentMediaIndex = 0;
                let propertyMedia = []; // Array of {type: 'image'|'video', url: string, alt?: string}

                // Handle "View Details" buttons safely via data attributes
                // NEW: Function to fetch data first, then open modal
                // NEW: Function to fetch data first, then open modal
                function fetchAndOpenModal(btn) {
                    const id = btn.dataset.id;

                    // OPTIMIZATION: Grab the main image directly from the visible card
                    const card = btn.closest('.property-card');
                    const mainImageSrc = card ? card.querySelector('img').src : '';

                    // 1. Open modal immediately with basic info
                    updateModalContent(
                        id,
                        btn.dataset.title,
                        btn.dataset.location,
                        btn.dataset.price,
                        btn.dataset.type,
                        btn.dataset.bedrooms,
                        btn.dataset.bathrooms,
                        btn.dataset.area,
                        "Loading details...",
                        "",
                        btn.dataset.status,
                        btn.dataset.agentName,
                        btn.dataset.agentLink,
                        btn.dataset.agentImage,
                        mainImageSrc,
                        btn.dataset.contactEmail,
                        btn.dataset.contactPhone,
                        "[]"
                    );

                    document.getElementById('propertyModal').classList.remove('hidden');
                    document.body.style.overflow = 'hidden';

                    // 2. Fetch the heavy data (Description + All Images) from server
                    fetch(`/api/property/${id}/`)
                        .then(response => response.json())
                        .then(data => {
                            document.getElementById('modalDescriptionText').textContent = data.description;
                            setupPropertyMedia(id, btn.dataset.title, JSON.stringify(data.images), mainImageSrc, JSON.stringify(data.media));
                        })
                        .catch(err => {
                            console.error("Error loading details:", err);
                            document.getElementById('modalDescriptionText').textContent = "Details could not be loaded.";
                        });
                }

                // Helper to update DOM elements
                function updateModalContent(id, title, location, price, propertyType, bedrooms, bathrooms, area, description, additionalImages, propertyStatus, listingAgentName, listingAgentLink, listingAgentImageUrl, mainImage, contactEmail, contactPhone, mediaData) {
                    document.getElementById('modal-title').textContent = title;
                    document.getElementById('modalLocation').textContent = location;

                    const contactPhoneLink = document.getElementById('modalContactPhone');
                    const contactEmailLink = document.getElementById('modalContactEmail');
                    if (contactPhoneLink && contactPhone) contactPhoneLink.href = 'tel:' + contactPhone.replace(/[^\d+]/g, '');
                    if (contactEmailLink && contactEmail) contactEmailLink.href = 'mailto:' + contactEmail;

                    const priceElement = document.getElementById('modalPrice');
                    const priceRow = priceElement.closest('.flex.justify-between');
                    if (propertyStatus === 'just_sold' || propertyStatus === 'for_lease') {
                        if (priceRow) priceRow.style.display = 'none';
                    } else {
                        if (priceRow) priceRow.style.display = 'flex';
                        if (price && price.trim()) {
                            const numericPrice = parseFloat(price);
                            if (!isNaN(numericPrice)) {
                                priceElement.textContent = propertyType === 'lease' ? '$' + numericPrice.toLocaleString() + '/month' : '$' + numericPrice.toLocaleString();
                            } else {
                                priceElement.textContent = price;
                            }
                        } else {
                            priceElement.textContent = '-';
                        }
                    }

                    const statusElement = document.getElementById('modalStatus');
                    if (statusElement) statusElement.textContent = propertyStatus ? propertyStatus.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) : '-';

                    document.getElementById('modalBedrooms').textContent = bedrooms || '-';
                    document.getElementById('modalBathrooms').textContent = bathrooms || '-';
                    document.getElementById('modalArea').textContent = area ? parseFloat(area).toLocaleString() : '-';

                    const agentSection = document.getElementById('modalListingAgent');
                    const agentNameEl = document.getElementById('modalListingAgentName');
                    const agentLinkEl = document.getElementById('modalListingAgentLink');
                    const agentImgEl = document.getElementById('modalListingAgentImage');

                    if (listingAgentName || listingAgentImageUrl) {
                        if (agentSection) agentSection.classList.remove('hidden');
                        if (agentNameEl) {
                            if (listingAgentLink) {
                                agentNameEl.innerHTML = `<a href="${listingAgentLink}" target="_blank" class="text-primary hover:underline">${listingAgentName}</a>`;
                            } else {
                                agentNameEl.textContent = listingAgentName || 'Listing Agent';
                            }
                        }
                        if (agentLinkEl) agentLinkEl.classList.toggle('hidden', !listingAgentLink);
                        if (agentImgEl) {
                            agentImgEl.classList.toggle('hidden', !listingAgentImageUrl);
                            if (listingAgentImageUrl) agentImgEl.src = listingAgentImageUrl;
                        }
                    } else {
                        if (agentSection) agentSection.classList.add('hidden');
                    }

                    document.getElementById('modalDescriptionText').textContent = description || '';
                    document.getElementById('modalDescription').classList.remove('hidden');

                    setupPropertyMedia(id, title, additionalImages, mainImage, mediaData);
                    setupPropertyFeatures(bedrooms, bathrooms, area, propertyType);
                }

                function parseImageList(imagesString) {
                    if (!imagesString || !imagesString.trim()) return [];
                    let raw = imagesString.trim();

                    // Decode HTML entities (fix escaped semicolons in base64 data URLs)
                    const textarea = document.createElement('textarea');
                    textarea.innerHTML = raw;
                    raw = textarea.value;

                    // Try JSON array
                    if (raw.startsWith('[') && raw.endsWith(']')) {
                        try {
                            const arr = JSON.parse(raw);
                            if (Array.isArray(arr)) return arr.filter(Boolean).map(url => {
                                // Decode HTML entities in each URL
                                const ta = document.createElement('textarea');
                                ta.innerHTML = url;
                                return ta.value;
                            });
                        } catch (_) {
                        }
                    }

                    // Try common separators
                    const separators = ['|||', '\n', ',', '|'];
                    for (const sep of separators) {
                        if (raw.includes(sep)) {
                            return raw.split(sep).map(s => {
                                const trimmed = s.trim();
                                if (!trimmed) return null;
                                // Decode HTML entities in each URL
                                const ta = document.createElement('textarea');
                                ta.innerHTML = trimmed;
                                return ta.value;
                            }).filter(Boolean);
                        }
                    }

                    // Decode single URL
                    const ta = document.createElement('textarea');
                    ta.innerHTML = raw;
                    return [ta.value];
                }

                function setupPropertyMedia(propertyId, title, additionalImages, mainImage, mediaData) {
                    propertyMedia = [];
                    const seenUrls = new Set(); // Track seen URLs to avoid duplicates

                    // Try to parse mediaData (JSON array with type and url)
                    try {
                        // Remove any HTML entities and clean the string
                        let cleanMediaData = mediaData || '[]';
                        if (typeof cleanMediaData === 'string') {
                            // Decode HTML entities
                            const textarea = document.createElement('textarea');
                            textarea.innerHTML = cleanMediaData;
                            cleanMediaData = textarea.value;
                        }

                        const mediaArray = JSON.parse(cleanMediaData);
                        console.log('Parsed media array:', mediaArray);

                        if (Array.isArray(mediaArray) && mediaArray.length > 0) {
                            mediaArray.forEach((item) => {
                                if (item && item.url && item.url.trim() && !seenUrls.has(item.url.trim())) {
                                    seenUrls.add(item.url.trim());
                                    propertyMedia.push({
                                        type: item.type || 'image',
                                        url: item.url.trim(),
                                        alt: title
                                    });
                                }
                            });
                        }
                    } catch (e) {
                        console.error('Could not parse mediaData:', e, 'Raw data:', mediaData);
                        console.log('Falling back to images only');
                    }

                    // Fallback: Parse all images from additionalImages (which includes main + all others)
                    if (propertyMedia.length === 0) {
                        const imageUrls = parseImageList(additionalImages);

                        // Add all images, avoiding duplicates
                        imageUrls.forEach((url) => {
                            if (url && url.trim() && !seenUrls.has(url.trim())) {
                                seenUrls.add(url.trim());
                                propertyMedia.push({
                                    type: 'image',
                                    url: url.trim(),
                                    alt: title
                                });
                            }
                        });

                        // Also add main image if it's not already in the list
                        if (mainImage && mainImage.trim() && !seenUrls.has(mainImage.trim())) {
                            propertyMedia.unshift({ // Add at the beginning
                                type: 'image',
                                url: mainImage.trim(),
                                alt: title
                            });
                        }
                    }

                    // If no media found, use a placeholder image
                    if (propertyMedia.length === 0) {
                        propertyMedia.push({
                            type: 'image',
                            url: '/static/Images/placeholder-property.jpg',
                            alt: title
                        });
                    }

                    console.log('Property media loaded:', propertyMedia.length, propertyMedia); // Debug

                    // Set up carousel
                    currentMediaIndex = 0;
                    updateMediaDisplay();
                    setupMediaNavigation();
                }

                function updateMediaDisplay() {
                    const imageElement = document.getElementById('modalImageSrc');
                    const videoElement = document.getElementById('modalVideoSrc');
                    const navigation = document.getElementById('imageNavigation');
                    const dotsContainer = document.getElementById('imageDots');

                    if (propertyMedia.length > 0 && currentMediaIndex >= 0 && currentMediaIndex < propertyMedia.length) {
                        const currentMedia = propertyMedia[currentMediaIndex];

                        // Hide both elements first
                        imageElement.classList.add('hidden');
                        videoElement.classList.add('hidden');

                        if (currentMedia.type === 'video') {
                            // Show video
                            let videoUrl = currentMedia.url;

                            // Handle YouTube/Vimeo embed URLs - use iframe instead of video element
                            if (videoUrl.includes('youtube.com/embed/') || videoUrl.includes('player.vimeo.com/video/')) {
                                // Create or update iframe for YouTube/Vimeo
                                let iframe = document.getElementById('modalVideoIframe');
                                if (!iframe) {
                                    iframe = document.createElement('iframe');
                                    iframe.id = 'modalVideoIframe';
                                    iframe.className = 'w-full h-full max-h-[24rem] transition-opacity duration-300';
                                    iframe.style.aspectRatio = '16/9'; // Standard video aspect ratio
                                    iframe.style.minHeight = '16rem';
                                    iframe.setAttribute('frameborder', '0');
                                    iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
                                    iframe.setAttribute('allowfullscreen', '');
                                    iframe.setAttribute('oncontextmenu', 'return false;');
                                    iframe.style.pointerEvents = 'auto';
                                    videoElement.parentElement.appendChild(iframe);
                                }
                                iframe.src = videoUrl;
                                iframe.classList.remove('hidden');
                                videoElement.classList.add('hidden');
                            } else {
                                // Use video element for direct video files
                                let iframe = document.getElementById('modalVideoIframe');
                                if (iframe) iframe.classList.add('hidden');

                                // Load video to get its dimensions
                                videoElement.src = videoUrl;
                                videoElement.classList.remove('hidden');

                                // Additional protection: prevent video download
                                videoElement.addEventListener('contextmenu', function (e) {
                                    e.preventDefault();
                                    return false;
                                });
                                videoElement.addEventListener('dragstart', function (e) {
                                    e.preventDefault();
                                    return false;
                                });

                                // Wait for video metadata to load, then adjust display based on aspect ratio
                                videoElement.onloadedmetadata = function () {
                                    const video = this;
                                    const container = video.parentElement;
                                    const videoAspectRatio = video.videoWidth / video.videoHeight;
                                    const containerWidth = container.offsetWidth || 600; // Fallback width
                                    const containerHeight = Math.min(container.offsetHeight || 384, 384); // Max 24rem
                                    const containerAspectRatio = containerWidth / containerHeight;

                                    // Reset styles first
                                    video.style.width = '';
                                    video.style.height = '';
                                    video.style.maxWidth = '';
                                    video.style.maxHeight = '';

                                    // Adjust video display based on aspect ratio
                                    if (videoAspectRatio > containerAspectRatio) {
                                        // Video is wider (landscape like 16:9) - fit to width
                                        video.style.width = '100%';
                                        video.style.height = 'auto';
                                        video.style.maxHeight = '24rem';
                                        video.style.objectFit = 'contain';
                                    } else {
                                        // Video is taller (portrait like 9:16) - fit to height, center horizontally
                                        video.style.width = 'auto';
                                        video.style.height = '100%';
                                        video.style.maxHeight = '24rem';
                                        video.style.maxWidth = '100%';
                                        video.style.objectFit = 'contain';
                                    }
                                };

                                // Wait for video metadata to load, then adjust display
                                videoElement.onloadedmetadata = function () {
                                    const video = this;
                                    const container = video.parentElement;
                                    const videoAspectRatio = video.videoWidth / video.videoHeight;
                                    const containerAspectRatio = container.offsetWidth / container.offsetHeight;

                                    // Adjust video display based on aspect ratio
                                    if (videoAspectRatio > containerAspectRatio) {
                                        // Video is wider (landscape) - fit to width
                                        video.style.width = '100%';
                                        video.style.height = 'auto';
                                        video.style.maxHeight = '24rem';
                                    } else {
                                        // Video is taller (portrait) - fit to height
                                        video.style.width = 'auto';
                                        video.style.height = '100%';
                                        video.style.maxHeight = '24rem';
                                        video.style.maxWidth = '100%';
                                    }
                                };

                                // Pause any previous video
                                videoElement.pause();
                            }
                        } else {
                            // Hide iframe when showing image
                            let iframe = document.getElementById('modalVideoIframe');
                            if (iframe) iframe.classList.add('hidden');

                            // Show image
                            imageElement.src = '';
                            imageElement.style.opacity = '0';

                            // Ensure image loads properly
                            imageElement.onerror = function () {
                                console.error('Failed to load image:', currentMediaIndex, currentMedia.url.substring(0, 100));
                                imageElement.style.opacity = '1';
                                // Try next media if available
                                if (propertyMedia.length > currentMediaIndex + 1) {
                                    currentMediaIndex++;
                                    updateMediaDisplay();
                                }
                            };

                            imageElement.onload = function () {
                                console.log('Image loaded successfully:', currentMediaIndex, propertyMedia.length);
                                imageElement.style.opacity = '1';
                            };

                            // Set new image source
                            imageElement.src = currentMedia.url;
                            imageElement.alt = currentMedia.alt || 'Property Image';
                            imageElement.classList.remove('hidden');

                            // Force opacity back in case onload doesn't fire (for cached images)
                            setTimeout(() => {
                                if (imageElement.complete) {
                                    imageElement.style.opacity = '1';
                                }
                            }, 100);
                        }

                        // Show/hide navigation based on number of media items
                        if (propertyMedia.length > 1) {
                            navigation.classList.remove('hidden');
                        } else {
                            navigation.classList.add('hidden');
                        }

                        setupImageDots();
                    } else {
                        console.error('No media or invalid index:', propertyMedia.length, currentMediaIndex);
                    }
                }

                function setupMediaNavigation() {
                    const prevButton = document.getElementById('prevImage');
                    const nextButton = document.getElementById('nextImage');

                    if (prevButton) {
                        prevButton.onclick = () => {
                            if (propertyMedia.length > 0) {
                                // Pause current video if playing
                                const videoElement = document.getElementById('modalVideoSrc');
                                if (videoElement && !videoElement.classList.contains('hidden')) {
                                    videoElement.pause();
                                }
                                // Clear iframe src to stop YouTube/Vimeo videos
                                const iframe = document.getElementById('modalVideoIframe');
                                if (iframe && !iframe.classList.contains('hidden')) {
                                    iframe.src = '';
                                }
                                currentMediaIndex = (currentMediaIndex - 1 + propertyMedia.length) % propertyMedia.length;
                                console.log('Previous media:', currentMediaIndex, propertyMedia.length);
                                updateMediaDisplay();
                            }
                        };
                    }

                    if (nextButton) {
                        nextButton.onclick = () => {
                            if (propertyMedia.length > 0) {
                                // Pause current video if playing
                                const videoElement = document.getElementById('modalVideoSrc');
                                if (videoElement && !videoElement.classList.contains('hidden')) {
                                    videoElement.pause();
                                }
                                // Clear iframe src to stop YouTube/Vimeo videos
                                const iframe = document.getElementById('modalVideoIframe');
                                if (iframe && !iframe.classList.contains('hidden')) {
                                    iframe.src = '';
                                }
                                currentMediaIndex = (currentMediaIndex + 1) % propertyMedia.length;
                                console.log('Next media:', currentMediaIndex, propertyMedia.length);
                                updateMediaDisplay();
                            }
                        };
                    }
                }

                function setupImageDots() {
                    const dotsContainer = document.getElementById('imageDots');
                    dotsContainer.innerHTML = '';

                    propertyMedia.forEach((media, index) => {
                        const dot = document.createElement('button');
                        dot.className = `w-3 h-3 rounded-full transition-all border-2 ${
                            index === currentMediaIndex
                                ? 'bg-white border-white shadow-lg'
                                : 'bg-white bg-opacity-30 border-white border-opacity-50 hover:bg-opacity-60'
                        }`;
                        // Add video indicator
                        if (media.type === 'video') {
                            dot.innerHTML = '<svg class="w-2 h-2" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>';
                        }
                        dot.onclick = () => {
                            // Pause current video if playing
                            const videoElement = document.getElementById('modalVideoSrc');
                            if (videoElement && !videoElement.classList.contains('hidden')) {
                                videoElement.pause();
                            }
                            currentMediaIndex = index;
                            updateMediaDisplay();
                        };
                        dotsContainer.appendChild(dot);
                    });
                }

                function setupPropertyFeatures(bedrooms, bathrooms, area, propertyType) {
                    console.log('Setting up features:', {bedrooms, bathrooms, area, propertyType});
                    const features = [];

                    // Add features based on available data
                    if (bedrooms && bedrooms > 0) {
                        features.push(`${bedrooms} Bedroom${bedrooms > 1 ? 's' : ''}`);
                    }

                    if (bathrooms && bathrooms > 0) {
                        features.push(`${bathrooms} Bathroom${bathrooms > 1 ? 's' : ''}`);
                    }

                    if (area && area > 0) {
                        features.push(`${parseInt(area).toLocaleString()} sq ft`);
                    }

                    // Add property type specific features
                    if (propertyType === 'lease') {
                        features.push('Available for Lease');
                    } else {
                        features.push('Available for Sale');
                    }

                    // Add some common features if we have basic data
                    if (bedrooms && bathrooms) {
                        features.push('Modern Design');
                        features.push('Well Maintained');
                    }

                    console.log('Generated features:', features);

                    const featuresContainer = document.getElementById('modalFeatures');
                    if (features.length > 0) {
                        featuresContainer.innerHTML = features.map(feature =>
                            `<span class="bg-secondary text-secondary-foreground px-3 py-1 rounded-full text-sm">${feature}</span>`
                        ).join('');
                    } else {
                        featuresContainer.innerHTML = '<span class="text-muted-foreground text-sm">No additional features listed</span>';
                    }
                }

                function closePropertyModal() {
                    document.getElementById('propertyModal').classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }

                // Close modal when clicking outside
                document.getElementById('propertyModal').addEventListener('click', function (e) {
                    if (e.target === this) {
                        closePropertyModal();
                    }
                });

                // Close modal with Escape key
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'Escape') {
                        closePropertyModal();
                    }
                });
            </script>

            <div id="heroContactModal"
                 class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-[9999] p-4"
                 style="z-index: 9999;">
                <div class="modal-content bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
                     style="background-color: white; border-radius: 0.5rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); max-width: 42rem;">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold" style="color: #111827; font-size: 1.25rem; font-weight: 700;">
                                Contact Raj</h3>
                            <button onclick="closeHeroContactModal()" type="button"
                                    class="text-gray-400 hover:text-gray-600"
                                    style="color: #9ca3af; transition: color 0.15s ease-in-out;">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                     style="width: 1.5rem; height: 1.5rem;">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>

                        <div class="mb-4 p-4 bg-gray-50 rounded-lg"
                             style="background-color: #f9fafb; border-radius: 0.5rem; margin-bottom: 1rem; padding: 1rem;">
                            <h4 class="font-semibold" style="font-weight: 600; color: #111827;">General Inquiry</h4>
                            <p class="text-sm" style="font-size: 0.875rem; color: #4b5563;">Looking to buy or sell? Fill
                                out the form below.</p>
                        </div>

                        <form action="{% url 'general_inquiry' %}" method="POST" id="heroContactForm">
                            {% csrf_token %}

                            <input type="hidden" name="source_page" value="Home Page Hero Button">

                            <div class="space-y-4" style="display: flex; flex-direction: column; gap: 1rem;">
                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Full
                                        Name *</label>
                                    <input type="text" name="name" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out;"
                                           placeholder="Your Name">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Email
                                        Address *</label>
                                    <input type="email" name="email" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out;"
                                           placeholder="you@example.com">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Phone
                                        Number *</label>
                                    <input type="tel" name="phone" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out;"
                                           placeholder="(832) 785-0140">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Additional
                                        Details / Requirements (Optional)</label>
                                    <textarea name="message" rows="3"
                                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                              style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out; resize: vertical;"
                                              placeholder="Tell us more about what you're looking for..."></textarea>
                                </div>
                            </div>

                            <div class="mt-6 flex gap-3" style="margin-top: 1.5rem; display: flex; gap: 0.75rem;">
                                <button type="button" onclick="closeHeroContactModal()"
                                        class="flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"
                                        style="flex: 1; padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; color: #374151; background-color: white; transition: all 0.15s ease-in-out; cursor: pointer;">
                                    Cancel
                                </button>
                                <button type="submit"
                                        class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                                        style="flex: 1; padding: 0.5rem 1rem; background-color: #2563eb; color: white; border-radius: 0.375rem; border: none; transition: all 0.15s ease-in-out; cursor: pointer;">
                                    Send Request
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>



            {% if messages %}
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        // This checks if Django sent any messages (Success or Error)
                        {% for message in messages %}
                            // Uses your existing notification function to show the popup
                            if (typeof showNotification === "function") {
                                showNotification("{{ message|escapejs }}");
                            } else {
                                alert("{{ message|escapejs }}"); // Fallback if function not found
                            }
                        {% endfor %}
                    });
                </script>
            {% endif %}

            <script>
                function openHeroContactModal() {
                    const modal = document.getElementById('heroContactModal');
                    modal.classList.remove('hidden');
                    document.body.style.overflow = 'hidden';
                }

                function closeHeroContactModal() {
                    const modal = document.getElementById('heroContactModal');
                    modal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }

                // Close on click outside
                document.getElementById('heroContactModal').addEventListener('click', function (e) {
                    if (e.target === this) {
                        closeHeroContactModal();
                    }
                });

                // Close on Escape key
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'Escape') {
                        closeHeroContactModal();
                    }
                });
            </script>
            <div id="propertyInquiryModal"
                 class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-[9999] p-4"
                 style="z-index: 9999;">
                <div class="modal-content bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
                     style="background-color: white; border-radius: 0.5rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); max-width: 42rem;">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold" style="color: #111827; font-size: 1.25rem; font-weight: 700;">
                                Contact Raj</h3>
                            <button type="button" onclick="closePropertyInquiryForm()"
                                    class="text-gray-400 hover:text-gray-600"
                                    style="color: #9ca3af; transition: color 0.15s ease-in-out;">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                     style="width: 1.5rem; height: 1.5rem;">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>

                        <div class="mb-4 p-4 bg-gray-50 rounded-lg"
                             style="background-color: #f9fafb; border-radius: 0.5rem; margin-bottom: 1rem; padding: 1rem;">
                            <h4 id="inquiryPropertyTitleDisplay" class="font-semibold"
                                style="font-weight: 600; color: #111827;">Property Name</h4>
                            <p id="inquiryPropertyLocationDisplay" class="text-sm"
                               style="font-size: 0.875rem; color: #4b5563;">Location</p>
                            <p class="text-xs text-blue-600 mt-2 font-medium">Inquiry Request</p>
                        </div>

                        <form action="{% url 'property_inquiry' %}" method="POST" id="propertyInquiryForm">
                            {% csrf_token %}

                            <input type="hidden" id="hiddenPropertyTitle">
                            <input type="hidden" name="requirements" id="realRequirementsField">

                            <div class="space-y-4" style="display: flex; flex-direction: column; gap: 1rem;">
                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Full
                                        Name *</label>
                                    <input type="text" name="name" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out;">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Phone
                                        Number *</label>
                                    <input type="tel" name="phone" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out;">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Email
                                        Address *</label>
                                    <input type="email" name="email" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out;">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1"
                                           style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Message</label>
                                    <textarea id="userMessage" rows="3"
                                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                              style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; outline: none; transition: all 0.15s ease-in-out; resize: vertical;"
                                              placeholder="I am interested in this property..."></textarea>
                                </div>
                            </div>

                            <div class="mt-6 flex gap-3" style="margin-top: 1.5rem; display: flex; gap: 0.75rem;">
                                <button type="button" onclick="closePropertyInquiryForm()"
                                        class="flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"
                                        style="flex: 1; padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; color: #374151; background-color: white; transition: all 0.15s ease-in-out; cursor: pointer;">
                                    Cancel
                                </button>
                                <button type="submit"
                                        class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                                        style="flex: 1; padding: 0.5rem 1rem; background-color: #2563eb; color: white; border-radius: 0.375rem; border: none; transition: all 0.15s ease-in-out; cursor: pointer;">
                                    Send Request
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <script>
                function openPropertyInquiryForm() {
                    // 1. Get Details from the background Property Modal
                    const title = document.getElementById('modal-title')?.textContent || 'Property';
                    const location = document.getElementById('modalLocation')?.textContent || '';

                    // 2. Update the Visible Gray Box
                    document.getElementById('inquiryPropertyTitleDisplay').textContent = title;
                    document.getElementById('inquiryPropertyLocationDisplay').textContent = location;

                    // 3. Store Title Securely
                    document.getElementById('hiddenPropertyTitle').value = title;

                    // 4. Pre-fill Message
                    const messageField = document.getElementById('userMessage');
                    if (!messageField.value) {
                        messageField.value = `I am interested in ${title}. Please contact me.`;
                    }

                    // 5. Show Modal
                    const modal = document.getElementById('propertyInquiryModal');
                    if (modal) {
                        modal.classList.remove('hidden');
                        // document.body.style.overflow = 'hidden'; // Optional
                    }
                }

                function closePropertyInquiryForm() {
                    const modal = document.getElementById('propertyInquiryModal');
                    if (modal) modal.classList.add('hidden');
                }

                // Handle Form Submission
                document.addEventListener('DOMContentLoaded', function () {
                    const inquiryForm = document.getElementById('propertyInquiryForm');
                    if (inquiryForm) {
                        inquiryForm.addEventListener('submit', function (e) {
                            e.preventDefault();

                            // 1. Get Data
                            const secureTitle = document.getElementById('hiddenPropertyTitle').value || 'Unknown Property';
                            const userMsg = document.getElementById('userMessage').value;
                            const name = inquiryForm.querySelector('input[name="name"]').value;

                            // 2. Combine Data for Admin
                            const finalRequirements = `[Property Inquiry: ${secureTitle}]\n\nUser Message: ${userMsg}`;
                            document.getElementById('realRequirementsField').value = finalRequirements;

                            // 3. Show Success & Close
                            if (typeof showNotification === 'function') {
                                showNotification(`Thank you, ${name}! Request sent.`);
                            } else {
                                alert('Request Sent! We will contact you shortly.');
                            }
                            closePropertyInquiryForm();

                            // 4. Submit
                            setTimeout(() => {
                                inquiryForm.submit();
                            }, 1000);
                        });
                    }
                });
            </script>
</body>

</html>