{% load static tailwind_tags %}
{% load humanize %}

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Buy & Lease Properties - {{ brand_name }}</title>
    <link rel="icon" type="image/svg+xml" href="{% static 'favicon.svg' %}">
    {% tailwind_css %}
    <link rel="stylesheet" href="{% static 'css/dist/styles.css' %}">
    <link rel="stylesheet" href="{% static 'css/modal-gallery.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Footer CSS Override -->
    <style>
    footer {
        background-color: #1f2937 !important;
        color: #d1d5db !important;
    }
    footer * {
        color: inherit !important;
    }
    footer h2, footer h3 {
        color: #ffffff !important;
    }
    footer p {
        color: #9ca3af !important;
    }
    footer .text-gray-500 {
        color: #6b7280 !important;
    }
    footer .text-gray-400 {
        color: #9ca3af !important;
    }
    footer .border-gray-700 {
        border-color: #374151 !important;
    }
    </style>
    
    <!-- Theme Toggle CSS -->
    <style>
    /* Dark theme styles */
    .dark-theme {
        background-color: #1a1a1a !important;
        color: #e5e5e5 !important;
    }
    
    .dark-theme .bg-gray-50 {
        background-color: #1a1a1a !important;
    }
    
    .dark-theme .bg-white {
        background-color: #2d2d2d !important;
    }
    
    .dark-theme .text-gray-900 {
        color: #e5e5e5 !important;
    }
    
    .dark-theme .text-gray-700 {
        color: #d1d5db !important;
    }
    
    .dark-theme .text-gray-600 {
        color: #9ca3af !important;
    }
    
    .dark-theme .bg-blue-50 {
        background-color: #1e3a8a !important;
    }
    
    /* Blue gradient backgrounds for dark mode */
    .dark-theme.bg-gradient-to-r.from-blue-900.to-blue-700 {
        background: linear-gradient(to right, #0f172a, #1e3a8a) !important;
    }
    
    .dark-theme.bg-blue-900 {
        background-color: #0f172a !important;
    }
    
    /* Form container will now change with theme */
    .form-container {
        transition: all 0.3s ease;
    }
    
    /* Light mode form styles - with high specificity */
    .form-container {
        background-color: #ffffff !important;
        color: #111827 !important;
    }
    
    .form-container .text-gray-900 {
        color: #111827 !important;
    }
    
    .form-container .text-gray-700 {
        color: #374151 !important;
    }
    
    .form-container input,
    .form-container select,
    .form-container textarea {
        background-color: #ffffff !important;
        color: #111827 !important;
        border-color: #d1d5db !important;
    }
    
    .form-container label {
        color: #374151 !important;
    }
    
    /* Dark mode form styles - with high specificity */
    .dark-theme .form-container {
        background-color: #2d2d2d !important;
        color: #e5e5e5 !important;
    }
    
    .dark-theme .form-container .text-gray-900 {
        color: #e5e5e5 !important;
    }
    
    .dark-theme .form-container .text-gray-700 {
        color: #d1d5db !important;
    }
    
    .dark-theme .form-container input,
    .dark-theme .form-container select,
    .dark-theme .form-container textarea {
        background-color: #374151 !important;
        color: #e5e5e5 !important;
        border-color: #4b5563 !important;
    }
    
    .dark-theme .form-container label {
        color: #d1d5db !important;
    }
    
    /* Ultra-specific overrides to ensure form changes with theme */
    body:not(.dark-theme) .form-container {
        background-color: #ffffff !important;
    }
    
    body:not(.dark-theme) .form-container .text-gray-900 {
        color: #111827 !important;
    }
    
    body:not(.dark-theme) .form-container .text-gray-700 {
        color: #374151 !important;
    }
    
    body:not(.dark-theme) .form-container input,
    body:not(.dark-theme) .form-container select,
    body:not(.dark-theme) .form-container textarea {
        background-color: #ffffff !important;
        color: #111827 !important;
        border-color: #d1d5db !important;
    }
    
    body:not(.dark-theme) .form-container label {
        color: #374151 !important;
    }
    
    body.dark-theme .form-container {
        background-color: #2d2d2d !important;
    }
    
    body.dark-theme .form-container .text-gray-900 {
        color: #e5e5e5 !important;
    }
    
    body.dark-theme .form-container .text-gray-700 {
        color: #d1d5db !important;
    }
    
    body.dark-theme .form-container input,
    body.dark-theme .form-container select,
    body.dark-theme .form-container textarea {
        background-color: #374151 !important;
        color: #e5e5e5 !important;
        border-color: #4b5563 !important;
    }
    
    body.dark-theme .form-container label {
        color: #d1d5db !important;
    }
    
    .dark-theme .bg-blue-600 {
        background-color: #2563eb !important;
    }
    
    /* Fix call to action text visibility in dark mode */
    .dark-theme .call-to-action h2,
    .dark-theme .call-to-action p {
        color: #ffffff !important;
    }
    
    /* Ensure the blue section text is always visible */
    .bg-blue-900 h2,
    .bg-blue-900 p {
        color: #ffffff !important;
    }
    
    .dark-theme .bg-blue-700 {
        background-color: #1d4ed8 !important;
    }
    
    .dark-theme .bg-blue-100 {
        background-color: #1e3a8a !important;
    }
    
    .dark-theme .bg-gradient-to-r.from-blue-50.to-indigo-50 {
        background: linear-gradient(to right, #1e3a8a, #312e81) !important;
    }
    
    .dark-theme .bg-gradient-to-r.from-blue-500.to-blue-600 {
        background: linear-gradient(to right, #2563eb, #1d4ed8) !important;
    }
    
    .dark-theme .hover\\:from-blue-600:hover {
        background: linear-gradient(to right, #1d4ed8, #1e40af) !important;
    }
    
    .dark-theme .hover\\:to-blue-700:hover {
        background: linear-gradient(to right, #1d4ed8, #1e40af) !important;
    }
    
    .dark-theme .bg-gray-100 {
        background-color: #374151 !important;
    }
    
    .dark-theme .border-gray-200 {
        border-color: #4b5563 !important;
    }
    
    .dark-theme .shadow-lg {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Modal dark theme styles */
    .dark-theme #propertyModal .bg-white {
        background-color: #1f2937 !important;
    }
    
    .dark-theme #propertyModal .text-gray-900 {
        color: #f9fafb !important;
    }
    
    .dark-theme #propertyModal .text-gray-700 {
        color: #d1d5db !important;
    }
    
    .dark-theme #propertyModal .text-gray-600 {
        color: #9ca3af !important;
    }
    
    .dark-theme #propertyModal .bg-gray-50 {
        background-color: #374151 !important;
    }
    
    .dark-theme #propertyModal .bg-blue-50 {
        background-color: #1e3a8a !important;
    }
    
    .dark-theme #propertyModal .bg-green-50 {
        background-color: #14532d !important;
    }
    
    .dark-theme #propertyModal .text-blue-700 {
        color: #93c5fd !important;
    }
    
    .dark-theme #propertyModal .text-green-700 {
        color: #86efac !important;
    }
    
    .dark-theme #propertyModal .border-b {
        border-color: #4b5563 !important;
    }
    
    .dark-theme #propertyModal .border-t {
        border-color: #4b5563 !important;
    }
    
    .dark-theme #propertyModal .bg-gray-50 {
        background-color: #374151 !important;
    }
    
    /* Image Modal Styling */
    #imageModal {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        background-color: rgba(0, 0, 0, 0.9) !important;
        z-index: 9999 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 20px !important;
    }
    
    #imageModal.hidden {
        display: none !important;
    }
    
    #imageModal:not(.hidden) {
        display: flex !important;
    }
    
    #imageModal .modal-content {
        position: relative !important;
        max-width: 90vw !important;
        max-height: 90vh !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
    }
    
    #imageModal img {
        max-width: 100% !important;
        max-height: 70vh !important;
        width: auto !important;
        height: auto !important;
        object-fit: contain !important;
        border-radius: 8px !important;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5) !important;
    }
    
    #imageModal .close-btn {
        position: absolute !important;
        top: -50px !important;
        right: 0 !important;
        background-color: rgba(255, 255, 255, 0.9) !important;
        color: #333 !important;
        border: none !important;
        width: 40px !important;
        height: 40px !important;
        border-radius: 50% !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        font-size: 18px !important;
        transition: all 0.3s ease !important;
    }
    
    #imageModal .close-btn:hover {
        background-color: rgba(255, 255, 255, 1) !important;
        transform: scale(1.1) !important;
    }
    
    #imageModal .nav-buttons {
        display: flex !important;
        gap: 15px !important;
        margin-top: 20px !important;
    }
    
    #imageModal .nav-btn {
        background-color: rgba(255, 255, 255, 0.9) !important;
        color: #333 !important;
        border: none !important;
        padding: 12px 20px !important;
        border-radius: 25px !important;
        cursor: pointer !important;
        font-size: 16px !important;
        transition: all 0.3s ease !important;
        display: flex !important;
        align-items: center !important;
        gap: 8px !important;
    }
    
    #imageModal .nav-btn:hover {
        background-color: rgba(255, 255, 255, 1) !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3) !important;
    }
    
    #imageModal .nav-btn:disabled {
        opacity: 0.5 !important;
        cursor: not-allowed !important;
    }
    
    #imageModal .nav-btn:disabled:hover {
        transform: none !important;
        box-shadow: none !important;
    }
    
    /* Modal CSS - Minimal overrides for Tailwind */
    #propertyModal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 9999;
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding: 20px;
        background-color: rgba(0, 0, 0, 0.6);
        overflow-y: auto;
    }
    
    #propertyModal.hidden {
        display: none;
    }
    
    .modal-backdrop {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: transparent;
    }
    
    .modal-container {
        background: white;
        border-radius: 16px;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        max-width: 800px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        position: relative;
        z-index: 10;
        margin: 20px auto;
        margin-top: 50px;
        margin-bottom: 50px;
    }
    
    /* Image styling - minimal overrides */
    #imageGallery img {
        cursor: pointer;
        transition: transform 0.2s ease;
    }
    
    #imageGallery img:hover {
        transform: scale(1.05);
    }
    
    /* Minimal overrides for specific needs */
    .bg-cover {
        background-size: cover;
        background-position: center;
    }
    
    /* Modal content styling - let Tailwind handle spacing */
    
    /* Let Tailwind handle grid display */
    
    /* Removed all Tailwind overrides - let Tailwind handle styling */
    
    /* All Tailwind overrides removed - let Tailwind handle styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All Tailwind overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All remaining overrides removed - Tailwind will handle all styling */
    
    /* All Tailwind overrides removed - Tailwind will handle all styling */
    
    /* Modal scrolling fixes */
    #propertyModal {
        overflow-y: auto;
    }
    
    .modal-container {
        max-height: 90vh;
        overflow: hidden;
    }
    
    .modal-content-scrollable {
        max-height: calc(90vh - 120px);
        overflow-y: auto;
    }
    
    /* Fix button visibility and alignment */
    #propertyModal .grid {
        display: grid !important;
    }
    
    #propertyModal .grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    }
    
    #propertyModal .gap-4 {
        gap: 1rem !important;
    }
    
    #propertyModal .text-center {
        text-align: center !important;
    }
    
    #propertyModal .flex {
        display: flex !important;
    }
    
    #propertyModal .items-center {
        align-items: center !important;
    }
    
    #propertyModal .justify-center {
        justify-content: center !important;
    }
    
    #propertyModal .justify-between {
        justify-content: space-between !important;
    }
    
    #propertyModal .p-5 {
        padding: 1.25rem !important;
    }
    
    #propertyModal .p-6 {
        padding: 1.5rem !important;
    }
    
    #propertyModal .text-lg {
        font-size: 1.125rem !important;
        line-height: 1.75rem !important;
    }
    
    #propertyModal .font-semibold {
        font-weight: 600 !important;
    }
    
    #propertyModal .bg-gradient-to-r {
        background-image: linear-gradient(to right, var(--tw-gradient-stops)) !important;
    }
    
    #propertyModal .from-blue-500 {
        --tw-gradient-from: #3b82f6 !important;
        --tw-gradient-to: rgb(59 130 246 / 0) !important;
        --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to) !important;
    }
    
    #propertyModal .to-blue-600 {
        --tw-gradient-to: #2563eb !important;
    }
    
    #propertyModal .from-green-500 {
        --tw-gradient-from: #22c55e !important;
        --tw-gradient-to: rgb(34 197 94 / 0) !important;
        --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to) !important;
    }
    
    #propertyModal .to-green-600 {
        --tw-gradient-to: #16a34a !important;
    }
    
    #propertyModal .text-white {
        color: #ffffff !important;
    }
    
    #propertyModal .rounded-xl {
        border-radius: 0.75rem !important;
    }
    
    #propertyModal .shadow-lg {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
    }
    
    #propertyModal .hover\\:scale-105:hover {
        transform: scale(1.05) !important;
    }
    
    #propertyModal .hover\\:shadow-xl:hover {
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
    }
    
    #propertyModal .transition-all {
        transition-property: all !important;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1) !important;
        transition-duration: 150ms !important;
    }
    
    #propertyModal .duration-300 {
        transition-duration: 300ms !important;
    }
    
    #propertyModal .transform {
        transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) !important;
    }
    
    #propertyModal .group:hover .group-hover\\:animate-pulse {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite !important;
    }
    
    /* Property details grid specific fixes */
    #propertyModal .space-y-6 > * + * {
        margin-top: 1.5rem !important;
    }
    
    #propertyModal .mb-3 {
        margin-bottom: 0.75rem !important;
    }
    
    #propertyModal .mb-2 {
        margin-bottom: 0.5rem !important;
    }
    
    #propertyModal .mb-1 {
        margin-bottom: 0.25rem !important;
    }
    
    #propertyModal .mx-auto {
        margin-left: auto !important;
        margin-right: auto !important;
    }
    
    #propertyModal .w-14 {
        width: 3.5rem !important;
    }
    
    #propertyModal .h-14 {
        height: 3.5rem !important;
    }
    
    #propertyModal .text-xl {
        font-size: 1.25rem !important;
        line-height: 1.75rem !important;
    }
    
    #propertyModal .text-xs {
        font-size: 0.75rem !important;
        line-height: 1rem !important;
    }
    
    #propertyModal .uppercase {
        text-transform: uppercase !important;
    }
    
    #propertyModal .tracking-wide {
        letter-spacing: 0.025em !important;
    }
    
    #propertyModal .font-semibold {
        font-weight: 600 !important;
    }
    
    #propertyModal .font-bold {
        font-weight: 700 !important;
    }
    
    #propertyModal .text-gray-800 {
        color: #1f2937 !important;
    }
    
    #propertyModal .text-gray-600 {
        color: #4b5563 !important;
    }
    
    #propertyModal .text-blue-600 {
        color: #2563eb !important;
    }
    
    #propertyModal .text-green-600 {
        color: #22c55e !important;
    }
    
    #propertyModal .text-purple-600 {
        color: #a855f7 !important;
    }
    
    #propertyModal .text-orange-600 {
        color: #f97316 !important;
    }
    
    #propertyModal .bg-blue-500 {
        background-color: #3b82f6 !important;
    }
    
    #propertyModal .bg-green-500 {
        background-color: #22c55e !important;
    }
    
    #propertyModal .bg-purple-500 {
        background-color: #a855f7 !important;
    }
    
    #propertyModal .bg-orange-500 {
        background-color: #f97316 !important;
    }
    
    #propertyModal .bg-gradient-to-br {
        background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)) !important;
    }
    
    #propertyModal .from-blue-50 {
        --tw-gradient-from: #eff6ff !important;
        --tw-gradient-to: rgb(239 246 255 / 0) !important;
        --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to) !important;
    }
    
    #propertyModal .to-blue-100 {
        --tw-gradient-to: #dbeafe !important;
    }
    
    #propertyModal .from-green-50 {
        --tw-gradient-from: #f0fdf4 !important;
        --tw-gradient-to: rgb(240 253 244 / 0) !important;
        --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to) !important;
    }
    
    #propertyModal .to-green-100 {
        --tw-gradient-to: #dcfce7 !important;
    }
    
    #propertyModal .from-purple-50 {
        --tw-gradient-from: #faf5ff !important;
        --tw-gradient-to: rgb(250 245 255 / 0) !important;
        --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to) !important;
    }
    
    #propertyModal .to-purple-100 {
        --tw-gradient-to: #f3e8ff !important;
    }
    
    #propertyModal .from-orange-50 {
        --tw-gradient-from: #fff7ed !important;
        --tw-gradient-to: rgb(255 247 237 / 0) !important;
        --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to) !important;
    }
    
    #propertyModal .to-orange-100 {
        --tw-gradient-to: #ffedd5 !important;
    }
    
    #propertyModal .border-blue-200 {
        border-color: #dbeafe !important;
    }
    
    #propertyModal .border-green-200 {
        border-color: #bbf7d0 !important;
    }
    
    #propertyModal .border-purple-200 {
        border-color: #e9d5ff !important;
    }
    
    #propertyModal .border-orange-200 {
        border-color: #fed7aa !important;
    }
    
    #propertyModal .shadow-md {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
    }
    
    #propertyModal .hover\\:shadow-lg:hover {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
    }
    
    #propertyModal .hover\\:scale-105:hover {
        transform: scale(1.05) !important;
    }
    
    #propertyModal .duration-300 {
        transition-duration: 300ms !important;
    }
    
    /* Enhanced Image Section Styling */
    #propertyModal .bg-gray-50 {
        background-color: #f9fafb !important;
    }
    
    #propertyModal .rounded-2xl {
        border-radius: 1rem !important;
    }
    
    #propertyModal .shadow-inner {
        box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06) !important;
    }
    
    #propertyModal .h-80 {
        height: 20rem !important;
    }
    
    #propertyModal .group-hover\\:shadow-2xl:hover {
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;
    }
    
    #propertyModal .group-hover\\:scale-\\[1\\.02\\]:hover {
        transform: scale(1.02) !important;
    }
    
    #propertyModal .bg-white\\/95 {
        background-color: rgba(255, 255, 255, 0.95) !important;
    }
    
    #propertyModal .backdrop-blur-sm {
        backdrop-filter: blur(4px) !important;
    }
    
    #propertyModal .border-gray-200 {
        border-color: #e5e7eb !important;
    }
    
    #propertyModal .bg-black\\/70 {
        background-color: rgba(0, 0, 0, 0.7) !important;
    }
    
    #propertyModal .bg-black\\/10 {
        background-color: rgba(0, 0, 0, 0.1) !important;
    }
    
    #propertyModal .bg-white\\/90 {
        background-color: rgba(255, 255, 255, 0.9) !important;
    }
    
    #propertyModal .h-20 {
        height: 5rem !important;
    }
    
    #propertyModal .rounded-lg {
        border-radius: 0.5rem !important;
    }
    
    #propertyModal .hover\\:scale-105:hover {
        transform: scale(1.05) !important;
    }
    
    #propertyModal .shadow-md {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
    }
    
    #propertyModal .hover\\:shadow-lg:hover {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
    }
    
    #propertyModal .text-blue-600 {
        color: #2563eb !important;
    }
    
    #propertyModal .gap-3 {
        gap: 0.75rem !important;
    }
    
    /* Theme toggle button */
    #theme-toggle {
        transition: all 0.3s ease;
    }
    
    #theme-icon {
        transition: transform 0.3s ease;
    }
    </style>
    
    <style>
        /* Fallback styles to ensure visibility */
        body { background-color: #f9fafb !important; color: #111827 !important; }
        .text-white { color: #ffffff !important; }
        .text-gray-900 { color: #111827 !important; }
        .text-gray-600 { color: #4b5563 !important; }
        .text-gray-700 { color: #374151 !important; }
        .bg-blue-900 { background-color: #1e3a8a !important; }
        .bg-blue-700 { background-color: #1d4ed8 !important; }
        .bg-white { background-color: #ffffff !important; }
        .bg-gray-50 { background-color: #f9fafb !important; }
        .bg-yellow-500 { background-color: #eab308 !important; }
        .bg-green-600 { background-color: #16a34a !important; }
        .bg-blue-600 { background-color: #2563eb !important; }
        .text-green-600 { color: #16a34a !important; }
        .text-blue-500 { color: #3b82f6 !important; }
        h1, h2, h3, h4, h5, h6 { color: #111827 !important; }
        p { color: #374151 !important; }
        .text-center h1 { color: #ffffff !important; }
        .text-center p { color: #ffffff !important; }
        /* Hero section specific styles */
        .bg-gradient-to-r h1 { color: #ffffff !important; }
        .bg-gradient-to-r p { color: #ffffff !important; }
        .bg-gradient-to-r .text-white { color: #ffffff !important; }
        .bg-gradient-to-r input { color: #111827 !important; background-color: #ffffff !important; }
        .bg-gradient-to-r select { color: #111827 !important; background-color: #ffffff !important; }
        .bg-gradient-to-r button { color: #ffffff !important; }
        
        /* Navbar styling is now handled globally in navbar.html */
        
    /* Mobile optimizations */
    @media (max-width: 768px) {
        .modal-container {
            margin: 10px !important;
            margin-top: 20px !important;
            margin-bottom: 20px !important;
            max-height: 95vh !important;
        }
        
        #propertyModal {
            padding: 10px !important;
        }
            .container {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
            
            .buy-lease-title {
                font-size: 2rem !important;
                line-height: 2.5rem !important;
                margin-bottom: 1rem !important;
            }
            
            .buy-lease-subtitle {
                font-size: 1rem !important;
                margin-bottom: 2rem !important;
            }
            
            .properties-grid {
                grid-template-columns: 1fr !important;
                gap: 1.5rem !important;
            }
            
            .property-card {
                padding: 1.5rem !important;
            }
            
            .property-image {
                height: 200px !important;
                margin-bottom: 1rem !important;
            }
            
            .property-title {
                font-size: 1.25rem !important;
                line-height: 1.75rem !important;
                margin-bottom: 0.75rem !important;
            }
            
            .property-price {
                font-size: 1.5rem !important;
                margin-bottom: 0.75rem !important;
            }
            
            .property-location {
                font-size: 0.875rem !important;
                margin-bottom: 0.75rem !important;
            }
            
            .property-details {
                font-size: 0.875rem !important;
                margin-bottom: 1rem !important;
            }
            
            .property-description {
                font-size: 0.875rem !important;
                line-height: 1.5rem !important;
                margin-bottom: 1rem !important;
            }
            
            .property-button {
                padding: 0.75rem 1.5rem !important;
                font-size: 0.875rem !important;
                width: 100% !important;
            }
            
            /* Mobile menu styles */
            #mobile-menu-toggle {
                display: block;
                background: none;
                border: none;
                color: white;
                font-size: 1.5rem;
                cursor: pointer;
                padding: 0.5rem;
            }
            
            .desktop-menu {
                display: none;
            }
            
            nav .flex {
                justify-content: space-between;
            }
            
            nav .text-lg {
                font-size: 1rem;
            }
        }
        
        /* Mobile menu styles for all screen sizes */
        #mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        #mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #1e40af;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 40;
        }

        #mobile-menu.show {
            display: block;
        }

        #mobile-menu ul {
            list-style: none;
            padding: 1rem;
            margin: 0;
        }

        #mobile-menu ul li {
            margin-bottom: 0.5rem;
        }

        #mobile-menu ul li a {
            display: block;
            padding: 0.75rem 1rem;
            color: white;
            text-decoration: none;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }

        #mobile-menu ul li a:hover {
            background-color: #1d4ed8;
            color: #93c5fd;
        }

        @media (min-width: 769px) {
            #mobile-menu {
                display: none !important;
            }
        }
    </style>
</head>
<body class="bg-gray-50" style="background-color: #f9fafb; color: #111827;">
    {% include 'Henry/navbar.html' %}

<div class="min-h-screen bg-gray-50">
    <!-- Hero Section -->
    <div class="bg-gradient-to-r from-blue-900 to-blue-700 text-white py-20 dark-theme" style="background: linear-gradient(to right, #1e3a8a, #1d4ed8); color: #ffffff;">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl md:text-6xl font-bold mb-6" style="color: #ffffff !important;">Find Your Perfect Property</h1>
                <p class="text-xl md:text-2xl mb-8" style="color: #ffffff !important;">Discover amazing properties for sale and lease in your area</p>
                
                <!-- Search and Filter Bar -->
                <div class="max-w-4xl mx-auto" style="max-width: 56rem !important;">
                    <form method="GET" class="flex flex-col md:flex-row gap-4" style="display: flex !important; flex-direction: column !important; gap: 1rem !important;">
                        <div class="flex-1" style="flex: 1 1 0% !important; min-width: 0 !important;">
                            <input type="text" name="search" value="{{ search_query }}" 
                                   placeholder="Search by location, address, or description..." 
                                   class="w-full px-4 py-3 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-300"
                                   style="width: 100% !important; color: #111827 !important; background-color: #ffffff !important; padding: 0.75rem 1rem !important; border-radius: 0.5rem !important;">
                        </div>
                        <div class="flex gap-3" style="display: flex !important; gap: 0.75rem !important; flex-shrink: 0 !important;">
                            <select name="type" class="px-4 py-3 pr-10 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-300 min-w-[140px] appearance-none bg-white"
                                    style="color: #111827 !important; background-color: #ffffff !important; min-width: 140px !important; padding: 0.75rem 2.5rem 0.75rem 1rem !important; border-radius: 0.5rem !important; background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 4 5\"><path fill=\"%23666\" d=\"M2 0L0 2h4zm0 5L0 3h4z\"/></svg>') !important; background-repeat: no-repeat !important; background-position: right 12px center !important; background-size: 12px !important; appearance: none !important;">
                                <option value="all" {% if current_type == 'all' %}selected{% endif %}>All Properties</option>
                                <option value="buy" {% if current_type == 'buy' %}selected{% endif %}>For Sale</option>
                                <option value="lease" {% if current_type == 'lease' %}selected{% endif %}>For Lease</option>
                            </select>
                            <button type="submit" class="bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-3 rounded-lg font-semibold transition duration-300 whitespace-nowrap"
                                    style="background-color: #eab308 !important; color: #ffffff !important; padding: 0.75rem 1.5rem !important; border-radius: 0.5rem !important; font-weight: 600 !important; white-space: nowrap !important;">
                                Search
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Properties Grid -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        {% if properties %}
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-2">
                    {% if current_type == 'buy' %}
                        Properties for Sale
                    {% elif current_type == 'lease' %}
                        Properties for Lease
                    {% else %}
                        All Properties
                    {% endif %}
                </h2>
                <p class="text-gray-600">{{ properties|length }} property{{ properties|length|pluralize }} found</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                {% for property in properties %}
                <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition duration-300 cursor-pointer {% if property.featured %}ring-2 ring-yellow-400{% endif %}" 
                     onclick="openPropertyModal({{ property.id }}, '{{ property.title|escapejs }}', '{{ property.location|escapejs }}', '{{ property.address|escapejs }}', '{{ property.price }}', '{{ property.property_type }}', '{{ property.bedrooms|default:"" }}', '{{ property.bathrooms|default:"" }}', '{{ property.parking_spaces|default:"" }}', '{{ property.area_sqft|default:"" }}', '{{ property.description|escapejs }}', '{{ property.get_main_image_url|escapejs }}', '{{ property.contact_email|escapejs }}', '{{ property.contact_phone|escapejs }}', {{ property.images.all|length }}, [{% for image in property.images.all %}'{{ image.get_image_url|escapejs }}'{% if not forloop.last %},{% endif %}{% endfor %}])">
                    {% if property.featured %}
                    <div class="bg-yellow-400 text-yellow-900 px-3 py-1 text-sm font-semibold text-center">
                        ⭐ FEATURED
                    </div>
                    {% endif %}
                    
                    <div class="relative">
                        <img src="{{ property.get_main_image_url }}" alt="{{ property.title }}" 
                             class="w-full h-64 object-cover">
                        <div class="absolute top-4 left-4">
                            <span class="bg-black bg-opacity-70 text-white px-3 py-1 rounded-full text-xs font-semibold">
                                {% if property.property_type == 'buy' %}💰 BUY{% else %}📋 LEASE{% endif %}
                            </span>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <!-- Title and Price -->
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-xl font-bold text-gray-900 flex-1 pr-3">{{ property.title }}</h3>
                            <div class="text-2xl font-bold text-green-600 whitespace-nowrap">
                                ${{ property.price|floatformat:0 }}
                                {% if property.property_type == 'lease' %}/month{% endif %}
                            </div>
                        </div>
                        
                        <!-- Location -->
                        <p class="text-gray-600 mb-4">
                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                            {{ property.location }}
                        </p>
                        
                        <!-- Property Details -->
                        <div class="flex items-center gap-4 mb-6 text-sm text-gray-600">
                            {% if property.bedrooms %}
                            <span class="flex items-center"><i class="fas fa-bed text-blue-500 mr-1"></i>{{ property.bedrooms }} bed{{ property.bedrooms|pluralize }}</span>
                            {% endif %}
                            {% if property.bathrooms %}
                            <span class="flex items-center"><i class="fas fa-bath text-blue-500 mr-1"></i>{{ property.bathrooms }} bath{{ property.bathrooms|pluralize }}</span>
                            {% endif %}
                            {% if property.area_sqft %}
                            <span class="flex items-center"><i class="fas fa-ruler-combined text-blue-500 mr-1"></i>{{ property.area_sqft }} sqft</span>
                            {% endif %}
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex justify-between items-center">
                            <button class="flex-1 bg-purple-600 hover:bg-purple-700 text-white text-center py-3 px-4 rounded-lg transition duration-300 font-medium mr-3">
                                <i class="fas fa-eye mr-2"></i>View Details
                            </button>
                            <a href="mailto:{{ property.contact_email }}?subject=Inquiry about {{ property.title }}" 
                               class="bg-blue-600 hover:bg-blue-700 text-white text-center py-3 px-4 rounded-lg transition duration-300 flex items-center justify-center min-w-[50px] mr-2">
                                <i class="fas fa-envelope"></i>
                            </a>
                            <a href="tel:{{ property.contact_phone }}" 
                               class="bg-green-600 hover:bg-green-700 text-white text-center py-3 px-4 rounded-lg transition duration-300 flex items-center justify-center min-w-[50px]">
                                <i class="fas fa-phone"></i>
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="text-center py-16">
                <div class="text-gray-400 text-6xl mb-4">
                    <i class="fas fa-search"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">No Properties Found</h3>
                <p class="text-gray-600 mb-6">
                    {% if search_query %}
                        No properties match your search criteria. Try adjusting your filters.
                    {% else %}
                        No properties are currently available. Check back soon!
                    {% endif %}
                </p>
                {% if search_query %}
                <a href="{% url 'buy_lease' %}" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-300">
                    View All Properties
                </a>
                {% endif %}
            </div>
        {% endif %}
    </div>

    <!-- Call to Action -->
    <div class="bg-blue-900 text-white py-16 dark-theme call-to-action">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl font-bold mb-4">Can't Find What You're Looking For?</h2>
            <p class="text-xl mb-8">Let us help you find the perfect property. Contact our team today!</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center mb-8">
                <a href="{% url 'selling' %}" class="bg-yellow-500 hover:bg-yellow-600 text-white px-8 py-3 rounded-lg font-semibold transition duration-300">
                    List Your Property
                </a>
                <a href="{% url 'selling' %}" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-lg font-semibold transition duration-300 shadow-lg hover:shadow-xl" style="background-color: #9333ea !important;">
                    Get Property Valuation
                </a>
            </div>
            
            <!-- Property Inquiry Form -->
            <div class="bg-white rounded-2xl p-8 max-w-4xl mx-auto shadow-2xl border border-gray-100 form-container">
                <div class="text-center mb-8">
                    <h3 class="text-3xl font-bold mb-4 text-gray-900">Tell Us What You're Looking For</h3>
                    <p class="text-lg text-gray-700">Our team will help you find the perfect property</p>
                </div>
                
                <form method="post" action="{% url 'property_inquiry' %}" class="space-y-6" id="propertyInquiryForm">
                    {% csrf_token %}
                    
                    <!-- Contact Information -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Full Name *</label>
                            <input type="text" name="name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                   placeholder="Enter your full name" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Email Address *</label>
                            <input type="email" name="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                   placeholder="Enter your email address" required>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Phone Number *</label>
                            <input type="tel" name="phone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                   placeholder="Enter your phone number" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Property Type</label>
                            <select name="property_type" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Select property type</option>
                                <option value="house">House</option>
                                <option value="apartment">Apartment</option>
                                <option value="condo">Condo</option>
                                <option value="townhouse">Townhouse</option>
                                <option value="commercial">Commercial</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Budget Range</label>
                            <select name="budget_range" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Select budget range</option>
                                <option value="under-300k">Under $300,000</option>
                                <option value="300k-500k">$300,000 - $500,000</option>
                                <option value="500k-750k">$500,000 - $750,000</option>
                                <option value="750k-1m">$750,000 - $1,000,000</option>
                                <option value="over-1m">Over $1,000,000</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Preferred Location</label>
                            <input type="text" name="location" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                   placeholder="e.g., Downtown, Suburbs">
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2 text-gray-700">Specific Requirements</label>
                        <textarea name="requirements" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                  placeholder="Tell us about your specific needs, preferences, must-haves, and any questions you may have..."></textarea>
                    </div>
                    
                    <!-- Submit Button -->
                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-6 rounded-lg transition duration-300">
                        <i class="fas fa-search mr-3"></i>
                        Find My Perfect Property
                    </button>
                </form>
            </div>
        </div>
    </div>
    </div>

    <!-- Popup Modal for Form Submission -->
    <div id="submissionModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md mx-4 text-center shadow-2xl">
            <div class="mb-4">
                <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-blue-600 dark:text-blue-400 animate-spin" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Sending Your Inquiry</h3>
                <p class="text-gray-600 dark:text-gray-300">Please wait while we process your request...</p>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md mx-4 text-center shadow-2xl">
            <div class="mb-4">
                <div class="w-8 h-8 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-4 h-4 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="stroke-width: 3;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Inquiry Sent Successfully!</h3>
                <p class="text-gray-600 dark:text-gray-300 mb-6">Thank you for your interest. Our team will contact you soon with property recommendations.</p>
                <button onclick="closeSuccessModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300">
                    Close
                </button>
        </div>
    </div>
</div>

<style>
.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Modal styles to override any conflicts */
#submissionModal, #successModal {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
}

#submissionModal:not(.hidden), #successModal:not(.hidden) {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
}

/* Ensure checkmark is small and visible */
#successModal svg {
    width: 16px !important;
    height: 16px !important;
    stroke-width: 3 !important;
}
</style>

{% include 'Henry/footer.html' %}

<script>
// Theme Toggle Functionality
document.addEventListener("DOMContentLoaded", function() {
    const themeToggle = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');
    const body = document.body;
    
    // Check for saved theme preference or default to light theme
    const currentTheme = localStorage.getItem('theme') || 'light';
    
    // Apply the saved theme
    if (currentTheme === 'dark') {
        body.classList.add('dark-theme');
        themeIcon.className = 'fas fa-sun text-white text-lg';
    } else {
        body.classList.remove('dark-theme');
        themeIcon.className = 'fas fa-moon text-white text-lg';
    }
    
    // Theme toggle event listener
    themeToggle.addEventListener('click', function() {
        if (body.classList.contains('dark-theme')) {
            // Switch to light theme
            body.classList.remove('dark-theme');
            themeIcon.className = 'fas fa-moon text-white text-lg';
            localStorage.setItem('theme', 'light');
        } else {
            // Switch to dark theme
            body.classList.add('dark-theme');
            themeIcon.className = 'fas fa-sun text-white text-lg';
            localStorage.setItem('theme', 'dark');
        }
    });
});

// Property Modal Functions
function openPropertyModal(id, title, location, address, price, propertyType, bedrooms, bathrooms, parkingSpaces, areaSqft, description, imageUrl, contactEmail, contactPhone, imageCount, additionalImages) {
    const modal = document.getElementById('propertyModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalLocation = document.getElementById('modalLocation');
    const modalAddress = document.getElementById('modalAddress');
    const modalPrice = document.getElementById('modalPrice');
    const modalPropertyType = document.getElementById('modalPropertyType');
    const modalBedrooms = document.getElementById('modalBedrooms');
    const modalBathrooms = document.getElementById('modalBathrooms');
    const modalParking = document.getElementById('modalParking');
    const modalArea = document.getElementById('modalArea');
    // Description removed for compact modal
    const modalImage = document.getElementById('modalImage');
    const modalContactEmail = document.getElementById('modalContactEmail');
    const modalContactPhone = document.getElementById('modalContactPhone');
    // Additional images removed for compact modal
    
    // Populate modal content
    modalTitle.textContent = title;
    modalLocation.textContent = location;
    modalAddress.textContent = address;
    modalPrice.textContent = '$' + parseFloat(price).toLocaleString() + (propertyType === 'lease' ? '/month' : '');
    modalPropertyType.textContent = propertyType === 'buy' ? '💰 FOR SALE' : '📋 FOR LEASE';
    // Description removed for compact modal
    if (imageUrl && imageUrl.trim() !== '') {
        modalImage.src = imageUrl;
        modalImage.alt = title;
        modalImage.style.display = 'block';
        modalImage.onerror = function() {
            this.style.display = 'none';
        };
    } else {
        modalImage.style.display = 'none';
    }
    
    // Contact info
    modalContactEmail.href = 'mailto:' + contactEmail + '?subject=Inquiry about ' + title;
    modalContactPhone.href = 'tel:' + contactPhone;
    
    // Handle additional images
    currentImages = additionalImages || [];
    currentImageIndex = 0;
    
    const imageGallery = document.getElementById('imageGallery');
    const galleryGrid = imageGallery.querySelector('.grid');
    
    if (currentImages.length > 1) {
        imageGallery.classList.remove('hidden');
        galleryGrid.innerHTML = '';
        
        // Update image count badge
        document.getElementById('imageCount').textContent = currentImages.length;
        document.getElementById('imageCountPlural').textContent = currentImages.length > 1 ? 's' : '';
        
        // Show additional images (skip the first one as it's the main image)
        currentImages.slice(1).forEach((imageUrl, index) => {
            const img = document.createElement('img');
            img.src = imageUrl;
            img.alt = `Property image ${index + 2}`;
            img.className = 'w-full h-20 object-cover rounded-lg cursor-pointer hover:opacity-80 hover:scale-105 transition-all duration-300 shadow-md hover:shadow-lg';
            img.onclick = () => {
                // Switch main image and open modal
                modalImage.src = imageUrl;
                currentImageIndex = index + 1; // +1 because we skipped the main image
                openImageModal();
            };
            galleryGrid.appendChild(img);
        });
    } else {
        imageGallery.classList.add('hidden');
        
        // Update image count badge for single image
        document.getElementById('imageCount').textContent = '1';
        document.getElementById('imageCountPlural').textContent = '';
    }
    
    // Property details
    modalBedrooms.textContent = bedrooms ? bedrooms + ' bed' + (bedrooms > 1 ? 's' : '') : 'N/A';
    modalBathrooms.textContent = bathrooms ? bathrooms + ' bath' + (bathrooms > 1 ? 's' : '') : 'N/A';
    modalParking.textContent = parkingSpaces ? parkingSpaces + ' parking space' + (parkingSpaces > 1 ? 's' : '') : 'N/A';
    modalArea.textContent = areaSqft ? areaSqft + ' sqft' : 'N/A';
    
    // Additional images removed for compact modal
    
    // Show modal
    modal.classList.remove('hidden');
    modal.style.display = 'flex';
    modal.style.visibility = 'visible';
    modal.style.opacity = '1';
    modal.style.pointerEvents = 'auto';
    document.body.style.overflow = 'hidden';
}

function closePropertyModal() {
    const modal = document.getElementById('propertyModal');
    if (modal) {
        // Force hide with multiple methods
        modal.style.display = 'none !important';
        modal.style.visibility = 'hidden';
        modal.style.opacity = '0';
        modal.style.pointerEvents = 'none';
        modal.classList.add('hidden');
        
        // Reset body overflow
        document.body.style.overflow = 'auto';
        document.body.style.paddingRight = '0';
    }
}

// Close modal when clicking outside or pressing Escape
document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('propertyModal');
    const backdrop = document.querySelector('.modal-backdrop');
    
    // Close modal when clicking on backdrop
    if (backdrop) {
        backdrop.addEventListener('click', function(e) {
            e.stopPropagation();
            closePropertyModal();
        });
    }
    
    // Close modal when clicking outside modal container
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            closePropertyModal();
        }
    });
    
    // Close modal when pressing Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal.style.display === 'flex') {
            closePropertyModal();
        }
    });
});
</script>

<!-- Property Details Modal -->
<div id="propertyModal" class="hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-container">
        <!-- Modal Header -->
        <div class="flex justify-between items-center p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50">
            <h2 id="modalTitle" class="text-2xl font-bold text-gray-900 pr-4"></h2>
            <button onclick="closePropertyModal()" class="text-gray-500 hover:text-gray-700 hover:bg-white rounded-full p-3 text-xl transition-all duration-200 shadow-sm">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <!-- Modal Content -->
        <div class="p-6 flex-1 modal-content-scrollable">
            <div class="space-y-6">
                <!-- Image Section -->
                <div class="relative bg-gray-50 rounded-2xl p-4 shadow-inner">
                    <!-- Main Image Container -->
                    <div class="relative group">
                        <img id="modalImage" src="" alt="" class="w-full h-80 object-cover rounded-xl shadow-lg cursor-pointer transition-all duration-300 group-hover:shadow-2xl group-hover:scale-[1.02]" onclick="openImageModal()">
                        
                        <!-- Property Type Badge -->
                        <div class="absolute top-4 right-4">
                            <span id="modalPropertyType" class="bg-white/95 backdrop-blur-sm text-gray-800 px-4 py-2 rounded-full text-sm font-semibold shadow-lg border border-gray-200"></span>
                        </div>
                        
                        <!-- Image Count Badge -->
                        <div id="imageCountBadge" class="absolute top-4 left-4 bg-black/70 text-white px-3 py-1 rounded-full text-sm font-medium backdrop-blur-sm">
                            <i class="fas fa-images mr-1"></i>
                            <span id="imageCount">1</span> image<span id="imageCountPlural">s</span>
                        </div>
                        
                        <!-- Click to View Fullscreen Hint -->
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-all duration-300 rounded-xl flex items-center justify-center">
                            <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white/90 text-gray-800 px-4 py-2 rounded-full text-sm font-medium shadow-lg">
                                <i class="fas fa-expand mr-2"></i>
                                Click to view fullscreen
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional Images Gallery -->
                    <div id="imageGallery" class="hidden mt-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-images mr-2 text-blue-600"></i>
                            Additional Images
                        </h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                            <!-- Additional images will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Price Section -->
                <div class="text-center bg-gradient-to-r from-green-50 to-emerald-50 p-6 rounded-xl border border-green-200">
                    <div class="text-4xl font-bold text-green-600 mb-2">
                        <span id="modalPrice"></span>
                    </div>
                    <div class="text-gray-600 text-sm font-medium">Asking Price</div>
                </div>
                
                <!-- Location Section -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-xl">
                    <div class="flex items-center justify-center mb-2">
                        <i class="fas fa-map-marker-alt text-blue-600 text-lg mr-2"></i>
                        <span id="modalLocation" class="text-gray-800 font-medium"></span>
                    </div>
                    <div class="text-center text-gray-600 text-sm">
                        <span id="modalAddress"></span>
                    </div>
                </div>
                
                <!-- Property Details Grid -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-5 text-center hover:shadow-lg hover:scale-105 transition-all duration-300">
                        <div class="bg-blue-500 w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md">
                            <i class="fas fa-bed text-white text-xl"></i>
                        </div>
                        <div class="text-xs text-blue-600 uppercase tracking-wide mb-1 font-semibold">Bedrooms</div>
                        <div id="modalBedrooms" class="font-bold text-gray-800 text-xl"></div>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-5 text-center hover:shadow-lg hover:scale-105 transition-all duration-300">
                        <div class="bg-green-500 w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md">
                            <i class="fas fa-bath text-white text-xl"></i>
                        </div>
                        <div class="text-xs text-green-600 uppercase tracking-wide mb-1 font-semibold">Bathrooms</div>
                        <div id="modalBathrooms" class="font-bold text-gray-800 text-xl"></div>
                    </div>
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-5 text-center hover:shadow-lg hover:scale-105 transition-all duration-300">
                        <div class="bg-purple-500 w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md">
                            <i class="fas fa-car text-white text-xl"></i>
                        </div>
                        <div class="text-xs text-purple-600 uppercase tracking-wide mb-1 font-semibold">Parking</div>
                        <div id="modalParking" class="font-bold text-gray-800 text-xl"></div>
                    </div>
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-xl p-5 text-center hover:shadow-lg hover:scale-105 transition-all duration-300">
                        <div class="bg-orange-500 w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md">
                            <i class="fas fa-ruler-combined text-white text-xl"></i>
                        </div>
                        <div class="text-xs text-orange-600 uppercase tracking-wide mb-1 font-semibold">Area (sq ft)</div>
                        <div id="modalArea" class="font-bold text-gray-800 text-xl"></div>
                    </div>
                </div>
                
                <!-- Contact Buttons -->
                <div class="grid grid-cols-2 gap-4">
                    <a id="modalContactEmail" href="#" class="group flex items-center justify-center p-5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
                        <i class="fas fa-envelope text-xl mr-3 group-hover:animate-pulse"></i>
                        <span class="font-semibold text-lg">Email Us</span>
                    </a>
                    <a id="modalContactPhone" href="#" class="group flex items-center justify-center p-5 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl">
                        <i class="fas fa-phone text-xl mr-3 group-hover:animate-pulse"></i>
                        <span class="font-semibold text-lg">Call Now</span>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Modal Footer - Removed for cleaner design -->
    </div>
</div>

<script>
// Form submission handling
document.getElementById('propertyInquiryForm').addEventListener('submit', function(e) {
    // Show loading modal
    document.getElementById('submissionModal').classList.remove('hidden');
    
    // The form will submit normally, but we show the loading state
    // The success message will be handled by Django's messages framework
});

// Function to close success modal
function closeSuccessModal() {
    document.getElementById('successModal').classList.add('hidden');
}

// Check if there's a success message from Django
document.addEventListener('DOMContentLoaded', function() {
    // First, ensure all modals are hidden on page load
    document.getElementById('submissionModal').classList.add('hidden');
    document.getElementById('successModal').classList.add('hidden');
    
    // Check for Django success messages (they might be in different formats)
    const successMessages = document.querySelectorAll('.messages .alert-success, .alert-success, .success');
    if (successMessages.length > 0) {
        // Hide loading modal if it's showing
        document.getElementById('submissionModal').classList.add('hidden');
        // Show success modal
        document.getElementById('successModal').classList.remove('hidden');
    }
    
    // Check for URL parameters or specific success indicators
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('success') === 'true' || urlParams.get('submitted') === 'true') {
        document.getElementById('submissionModal').classList.add('hidden');
        document.getElementById('successModal').classList.remove('hidden');
    }
});

// Close modals when clicking outside
document.getElementById('submissionModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
    }
});

document.getElementById('successModal').addEventListener('click', function(e) {
    if (e.target === this) {
        this.classList.add('hidden');
    }
});

// Mobile menu toggle functionality
document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (mobileMenuToggle && mobileMenu) {
        mobileMenuToggle.addEventListener('click', function() {
            mobileMenu.classList.toggle('show');
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            if (!mobileMenuToggle.contains(event.target) && !mobileMenu.contains(event.target)) {
                mobileMenu.classList.remove('show');
            }
        });
    }
    
    // Mobile theme toggle
    const themeToggleMobile = document.getElementById('theme-toggle-mobile');
    const themeIconMobile = document.getElementById('theme-icon-mobile');
    
    if (themeToggleMobile && themeIconMobile) {
        themeToggleMobile.addEventListener('click', function() {
            // Trigger the main theme toggle
            const mainThemeToggle = document.getElementById('theme-toggle');
            if (mainThemeToggle) {
                mainThemeToggle.click();
            }
        });
    }
});

// Image Gallery Variables
let currentImages = [];
let currentImageIndex = 0;

// Image Modal Functions
function openImageModal() {
    // Get the main image and additional images
    const mainImage = document.getElementById('modalImage').src;
    const additionalImages = Array.from(document.querySelectorAll('#imageGallery img')).map(img => img.src);
    
    // Combine main image with additional images
    currentImages = [mainImage, ...additionalImages];
    currentImageIndex = 0;
    
    if (currentImages.length > 0) {
        document.getElementById('imageModal').classList.remove('hidden');
        document.getElementById('modalImageFull').src = currentImages[currentImageIndex];
        updateImageNavigation();
    }
}

function closeImageModal() {
    document.getElementById('imageModal').classList.add('hidden');
}

function previousImage() {
    if (currentImages.length > 0) {
        currentImageIndex = (currentImageIndex - 1 + currentImages.length) % currentImages.length;
        document.getElementById('modalImageFull').src = currentImages[currentImageIndex];
        updateImageNavigation();
    }
}

function nextImage() {
    if (currentImages.length > 0) {
        currentImageIndex = (currentImageIndex + 1) % currentImages.length;
        document.getElementById('modalImageFull').src = currentImages[currentImageIndex];
        updateImageNavigation();
    }
}

function updateImageNavigation() {
    const prevBtn = document.getElementById('prevImage');
    const nextBtn = document.getElementById('nextImage');
    
    if (currentImages.length <= 1) {
        prevBtn.disabled = true;
        nextBtn.disabled = true;
    } else {
        prevBtn.disabled = false;
        nextBtn.disabled = false;
    }
}

// Close image modal with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeImageModal();
    }
});
</script>

<!-- Image Modal -->
<div id="imageModal" class="hidden">
    <div class="modal-content">
        <button onclick="closeImageModal()" class="close-btn">
            <i class="fas fa-times"></i>
        </button>
        <img id="modalImageFull" src="" alt="">
        <div class="nav-buttons">
            <button id="prevImage" onclick="previousImage()" class="nav-btn">
                <i class="fas fa-chevron-left"></i>
                Previous
            </button>
            <button id="nextImage" onclick="nextImage()" class="nav-btn">
                Next
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
</div>

</body>
</html>
